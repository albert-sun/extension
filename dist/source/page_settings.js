(()=>{"use strict";var e,t={8681:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSettings=void 0,t.defaultSettings={bestbuy:[{key:"automaticQueueFix",description:"Attempt to automatically fix broken queues",type:"slideSwitch",value:!0},{key:"autoClickWhitelisted",description:"Automatically click whitelisted ATC buttons",type:"slideSwitch",value:!0},{key:"stopClickCartOccupied",description:"Stop automatic clicking when cart occupied",type:"slideSwitch",value:!0},{key:"globalPollingInterval",description:"Global content script polling interval",type:"number",extraText:"ms",value:100},{key:"successiveClickTimeout",description:"Timeout between successive button clicks",type:"number",extraText:"ms",value:2500},{key:"notificationSoundURL",description:"Custom notification sound URL (mp3 hotlink)",type:"text",value:"https://github.com/albert-sun/tamper-scripts/blob/main/resources/notification.mp3?raw=true"},{key:"testNotificationSound",description:"Play current notification sound",type:"button",instruction:"testNotificationSound"}]}},735:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(9416),r=n(1209),c=n(8681);function s(e,t,n=!0){return o(this,void 0,void 0,(function*(){if(yield i.browser.storage.local.set({[`setting-${e}`]:t}),!0===n){const n=yield i.browser.tabs.query({}),o={instruction:"updatedSetting",arguments:[e,t]};for(const e of n)i.browser.tabs.sendMessage(e.id,o)}}))}function a(e,t=[]){return o(this,void 0,void 0,(function*(){const n=yield i.browser.tabs.query({}),o={instruction:e,arguments:t};for(const e of n)i.browser.tabs.sendMessage(e.id,o)}))}!function(){o(this,void 0,void 0,(function*(){const e=c.defaultSettings;for(const[t,n]of Object.entries(e))e[t]=yield r.retrieveSettings(t);for(const[t,n]of Object.entries(c.defaultSettings)){const n=$(`#settings-${t}`)[0];for(const o of e[t]){const e=document.createElement("tr");e.classList.add("table-row"),n.appendChild(e);const i=document.createElement("td");i.classList.add("table-element-left"),e.appendChild(i);const r=document.createElement("td");r.classList.add("table-element-right"),e.appendChild(r),i.innerText=o.description;const c=`${t}-${o.key}`;let u;if("button"===o.type)u=document.createElement("a"),u.classList.add("table-button"),u.href="#",u.innerText="Click me!",u.onclick=function(){a(o.instruction)};else if("slideSwitch"===o.type){u=document.createElement("label"),u.classList.add("switch");const e=document.createElement("input");u.appendChild(e),e.type="checkbox",e.checked=o.value,$(e).change((function(){s(c,e.checked)}));const t=document.createElement("span");t.classList.add("slider"),t.classList.add("round"),u.appendChild(t)}else u=document.createElement("input"),u.classList.add("table-input"),u.type=o.type,u.value=o.value,$(u).change((function(){s(c,u.value)}));if(r.appendChild(u),"button"!==o.type&&"checkbox"!==o.type&&o.extraText){const e=document.createElement("p");e.classList.add("table-extra"),e.textContent=o.extraText,r.appendChild(e)}}}}))}()},1209:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function c(e){try{a(o.next(e))}catch(e){r(e)}}function s(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveSettingsKV=t.retrieveSettings=t.storageGet=t.elementColor=t.sleep=void 0;const i=n(9416),r=n(8681);t.sleep=function(e){return new Promise((t=>setTimeout(t,e)))};const c=[{color:"yellow",r:255,g:224,b:0},{color:"blue",r:0,g:30,b:115},{color:"grey",r:197,g:203,b:213},{color:"white",r:255,g:255,b:255}];function s(e,t){return o(this,void 0,void 0,(function*(){const n=yield i.browser.storage.local.get(e);return void 0!==n[e]?n[e]:t}))}function a(e){return o(this,void 0,void 0,(function*(){const t=r.defaultSettings[e];for(const n of t){if(void 0===n.value)continue;const t=`setting-${e}-${n.key}`;n.value=yield s(t,n.value)}return t}))}t.elementColor=function(e){const t=getComputedStyle(e,null).getPropertyValue("background-color");if(t.includes("rgb(0, 0, 0"))return"transparent";const n={r:0,g:0,b:0},o=t.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i);n.r=Number(o[1]),n.g=Number(o[2]),n.b=Number(o[3]);const i={color:"",distance:442};for(const e of c){const t=Math.sqrt(Math.pow(n.r-e.r,2)+Math.pow(n.g-e.g,2)+(n.b-e.b));t<i.distance&&(i.color=e.color,i.distance=t)}return i.color},t.storageGet=s,t.retrieveSettings=a,t.retrieveSettingsKV=function(e){return o(this,void 0,void 0,(function*(){const t={},n=yield a(e);for(const e of n)void 0!==e.value&&(t[e.key]=e);return t}))}}},n={};function o(e){var i=n[e];if(void 0!==i)return i.exports;var r=n[e]={exports:{}};return t[e].call(r.exports,r,r.exports,o),r.exports}o.m=t,e=[],o.O=(t,n,i,r)=>{if(!n){var c=1/0;for(u=0;u<e.length;u++){for(var[n,i,r]=e[u],s=!0,a=0;a<n.length;a++)(!1&r||c>=r)&&Object.keys(o.O).every((e=>o.O[e](n[a])))?n.splice(a--,1):(s=!1,r<c&&(c=r));s&&(e.splice(u--,1),t=i())}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[n,i,r]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.j=436,(()=>{var e={436:0,533:0,386:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var i,r,[c,s,a]=n,u=0;for(i in s)o.o(s,i)&&(o.m[i]=s[i]);if(a)var l=a(o);for(t&&t(n);u<c.length;u++)r=c[u],o.o(e,r)&&e[r]&&e[r][0](),e[c[u]]=0;return o.O(l)},n=self.webpackChunkextension=self.webpackChunkextension||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var i=o.O(void 0,[736],(()=>o(735)));i=o.O(i)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leHRlbnNpb24vd2VicGFjay9ydW50aW1lL2NodW5rIGxvYWRlZCIsIndlYnBhY2s6Ly9leHRlbnNpb24vLi9zb3VyY2UvY29uc3RhbnRzLnRzIiwid2VicGFjazovL2V4dGVuc2lvbi8uL3NvdXJjZS9wYWdlX3NldHRpbmdzLnRzIiwid2VicGFjazovL2V4dGVuc2lvbi8uL3NvdXJjZS91dGlsaXRpZXMudHMiLCJ3ZWJwYWNrOi8vZXh0ZW5zaW9uL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2V4dGVuc2lvbi93ZWJwYWNrL3J1bnRpbWUvY29tcGF0IGdldCBkZWZhdWx0IGV4cG9ydCIsIndlYnBhY2s6Ly9leHRlbnNpb24vd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL2V4dGVuc2lvbi93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovL2V4dGVuc2lvbi93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL2V4dGVuc2lvbi93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL2V4dGVuc2lvbi93ZWJwYWNrL3J1bnRpbWUvcnVudGltZUlkIiwid2VicGFjazovL2V4dGVuc2lvbi93ZWJwYWNrL3J1bnRpbWUvanNvbnAgY2h1bmsgbG9hZGluZyIsIndlYnBhY2s6Ly9leHRlbnNpb24vd2VicGFjay9zdGFydHVwIl0sIm5hbWVzIjpbImRlZmVycmVkIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJkZWZhdWx0U2V0dGluZ3MiLCJrZXkiLCJkZXNjcmlwdGlvbiIsInR5cGUiLCJleHRyYVRleHQiLCJpbnN0cnVjdGlvbiIsIl9fYXdhaXRlciIsInRoaXMiLCJ0aGlzQXJnIiwiX2FyZ3VtZW50cyIsIlAiLCJnZW5lcmF0b3IiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImZ1bGZpbGxlZCIsInN0ZXAiLCJuZXh0IiwiZSIsInJlamVjdGVkIiwicmVzdWx0IiwiZG9uZSIsInRoZW4iLCJhcHBseSIsIndlYmV4dGVuc2lvbl9wb2x5ZmlsbF90c18xIiwidXRpbGl0aWVzXzEiLCJjb25zdGFudHNfMSIsInVwZGF0ZVNldHRpbmciLCJzZXR0aW5nS2V5Iiwic2V0dGluZ1ZhbHVlIiwibm90aWZ5IiwiYnJvd3NlciIsInN0b3JhZ2UiLCJsb2NhbCIsInNldCIsInRhYnMiLCJxdWVyeSIsIm1lc3NhZ2UiLCJ0YWIiLCJzZW5kTWVzc2FnZSIsImlkIiwiYnJvYWRjYXN0SW5zdHJ1Y3Rpb24iLCJhcmdzIiwiY3VycmVudFNldHRpbmdzIiwic2V0dGluZ3NDYXRlZ29yeSIsIl8iLCJlbnRyaWVzIiwicmV0cmlldmVTZXR0aW5ncyIsInNldHRpbmdzVGFibGUiLCIkIiwic2V0dGluZyIsInNldHRpbmdSb3ciLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsImxlZnREZXNjcmlwdGlvbiIsInJpZ2h0RGVzY3JpcHRpb24iLCJpbm5lclRleHQiLCJzZXR0aW5nUmlnaHQiLCJocmVmIiwib25jbGljayIsInVuZGVyQ2hlY2siLCJjaGVja2VkIiwiY2hhbmdlIiwidW5kZXJTcGFuIiwidGV4dENvbnRlbnQiLCJwb3B1bGF0ZVNldHRpbmdzIiwicmV0cmlldmVTZXR0aW5nc0tWIiwic3RvcmFnZUdldCIsImVsZW1lbnRDb2xvciIsInNsZWVwIiwibXMiLCJzZXRUaW1lb3V0IiwiY29sb3JzIiwiY29sb3IiLCJyIiwiZyIsImIiLCJzdG9yYWdlS2V5IiwiZGVmYXVsdFZhbHVlIiwic3RvcmFnZVJlc3VsdCIsImdldCIsInVuZGVmaW5lZCIsImNhdGVnb3J5U2V0dGluZ3MiLCJlbGVtZW50IiwiY29sb3JUZXh0IiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImdldFByb3BlcnR5VmFsdWUiLCJpbmNsdWRlcyIsInBhcnNlZENvbG9yIiwibWF0Y2hlZENvbG9yIiwibWF0Y2giLCJOdW1iZXIiLCJjbG9zZXN0IiwiZGlzdGFuY2UiLCJjaGVja0NvbG9yIiwiTWF0aCIsInNxcnQiLCJwb3ciLCJjYXRlZ29yeVNldHRpbmdzS1YiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiY2FsbCIsIm0iLCJPIiwiY2h1bmtJZHMiLCJmbiIsInByaW9yaXR5Iiwibm90RnVsZmlsbGVkIiwiSW5maW5pdHkiLCJpIiwibGVuZ3RoIiwiaiIsImtleXMiLCJldmVyeSIsInNwbGljZSIsIm4iLCJnZXR0ZXIiLCJfX2VzTW9kdWxlIiwiZCIsImEiLCJkZWZpbml0aW9uIiwibyIsImVudW1lcmFibGUiLCJnbG9iYWxUaGlzIiwiRnVuY3Rpb24iLCJ3aW5kb3ciLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsImluc3RhbGxlZENodW5rcyIsImNodW5rSWQiLCJ3ZWJwYWNrSnNvbnBDYWxsYmFjayIsInBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uIiwiZGF0YSIsIm1vcmVNb2R1bGVzIiwicnVudGltZSIsImNodW5rTG9hZGluZ0dsb2JhbCIsInNlbGYiLCJmb3JFYWNoIiwiYmluZCIsInB1c2giLCJfX3dlYnBhY2tfZXhwb3J0c19fIl0sIm1hcHBpbmdzIjoidUJBQUlBLEUsZ0JDQ0pDLE9BQU9DLGVBQWVDLEVBQVMsYUFBYyxDQUFFQyxPQUFPLElBQ3RERCxFQUFRRSxxQkFBa0IsRUFFMUJGLEVBQVFFLGdCQUFrQixDQUN0QixRQUFXLENBQ1AsQ0FBRUMsSUFBSyxvQkFBcUJDLFlBQWEsNkNBQThDQyxLQUFNLGNBQWVKLE9BQU8sR0FDbkgsQ0FBRUUsSUFBSyx1QkFBd0JDLFlBQWEsOENBQStDQyxLQUFNLGNBQWVKLE9BQU8sR0FD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dHRpbmdzLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGRlZmVycmVkID0gW107XG5fX3dlYnBhY2tfcmVxdWlyZV9fLk8gPSAocmVzdWx0LCBjaHVua0lkcywgZm4sIHByaW9yaXR5KSA9PiB7XG5cdGlmKGNodW5rSWRzKSB7XG5cdFx0cHJpb3JpdHkgPSBwcmlvcml0eSB8fCAwO1xuXHRcdGZvcih2YXIgaSA9IGRlZmVycmVkLmxlbmd0aDsgaSA+IDAgJiYgZGVmZXJyZWRbaSAtIDFdWzJdID4gcHJpb3JpdHk7IGktLSkgZGVmZXJyZWRbaV0gPSBkZWZlcnJlZFtpIC0gMV07XG5cdFx0ZGVmZXJyZWRbaV0gPSBbY2h1bmtJZHMsIGZuLCBwcmlvcml0eV07XG5cdFx0cmV0dXJuO1xuXHR9XG5cdHZhciBub3RGdWxmaWxsZWQgPSBJbmZpbml0eTtcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBkZWZlcnJlZC5sZW5ndGg7IGkrKykge1xuXHRcdHZhciBbY2h1bmtJZHMsIGZuLCBwcmlvcml0eV0gPSBkZWZlcnJlZFtpXTtcblx0XHR2YXIgZnVsZmlsbGVkID0gdHJ1ZTtcblx0XHRmb3IgKHZhciBqID0gMDsgaiA8IGNodW5rSWRzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRpZiAoKHByaW9yaXR5ICYgMSA9PT0gMCB8fCBub3RGdWxmaWxsZWQgPj0gcHJpb3JpdHkpICYmIE9iamVjdC5rZXlzKF9fd2VicGFja19yZXF1aXJlX18uTykuZXZlcnkoKGtleSkgPT4gKF9fd2VicGFja19yZXF1aXJlX18uT1trZXldKGNodW5rSWRzW2pdKSkpKSB7XG5cdFx0XHRcdGNodW5rSWRzLnNwbGljZShqLS0sIDEpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZnVsZmlsbGVkID0gZmFsc2U7XG5cdFx0XHRcdGlmKHByaW9yaXR5IDwgbm90RnVsZmlsbGVkKSBub3RGdWxmaWxsZWQgPSBwcmlvcml0eTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYoZnVsZmlsbGVkKSB7XG5cdFx0XHRkZWZlcnJlZC5zcGxpY2UoaS0tLCAxKVxuXHRcdFx0cmVzdWx0ID0gZm4oKTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIHJlc3VsdDtcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5kZWZhdWx0U2V0dGluZ3MgPSB2b2lkIDA7XHJcbi8vIFNldHRpbmdzIGFjcm9zcyBhbGwgY2F0ZWdvcmllcyBmb3IgZXh0ZW5zaW9uXHJcbmV4cG9ydHMuZGVmYXVsdFNldHRpbmdzID0ge1xyXG4gICAgXCJiZXN0YnV5XCI6IFtcclxuICAgICAgICB7IGtleTogXCJhdXRvbWF0aWNRdWV1ZUZpeFwiLCBkZXNjcmlwdGlvbjogXCJBdHRlbXB0IHRvIGF1dG9tYXRpY2FsbHkgZml4IGJyb2tlbiBxdWV1ZXNcIiwgdHlwZTogXCJzbGlkZVN3aXRjaFwiLCB2YWx1ZTogdHJ1ZSB9LFxyXG4gICAgICAgIHsga2V5OiBcImF1dG9DbGlja1doaXRlbGlzdGVkXCIsIGRlc2NyaXB0aW9uOiBcIkF1dG9tYXRpY2FsbHkgY2xpY2sgd2hpdGVsaXN0ZWQgQVRDIGJ1dHRvbnNcIiwgdHlwZTogXCJzbGlkZVN3aXRjaFwiLCB2YWx1ZTogdHJ1ZSB9LFxyXG4gICAgICAgIHsga2V5OiBcInN0b3BDbGlja0NhcnRPY2N1cGllZFwiLCBkZXNjcmlwdGlvbjogXCJTdG9wIGF1dG9tYXRpYyBjbGlja2luZyB3aGVuIGNhcnQgb2NjdXBpZWRcIiwgdHlwZTogXCJzbGlkZVN3aXRjaFwiLCB2YWx1ZTogdHJ1ZSB9LFxyXG4gICAgICAgIHsga2V5OiBcImdsb2JhbFBvbGxpbmdJbnRlcnZhbFwiLCBkZXNjcmlwdGlvbjogXCJHbG9iYWwgY29udGVudCBzY3JpcHQgcG9sbGluZyBpbnRlcnZhbFwiLCB0eXBlOiBcIm51bWJlclwiLCBleHRyYVRleHQ6IFwibXNcIiwgdmFsdWU6IDEwMCB9LFxyXG4gICAgICAgIHsga2V5OiBcInN1Y2Nlc3NpdmVDbGlja1RpbWVvdXRcIiwgZGVzY3JpcHRpb246IFwiVGltZW91dCBiZXR3ZWVuIHN1Y2Nlc3NpdmUgYnV0dG9uIGNsaWNrc1wiLCB0eXBlOiBcIm51bWJlclwiLCBleHRyYVRleHQ6IFwibXNcIiwgdmFsdWU6IDI1MDAgfSxcclxuICAgICAgICB7IGtleTogXCJub3RpZmljYXRpb25Tb3VuZFVSTFwiLCBkZXNjcmlwdGlvbjogXCJDdXN0b20gbm90aWZpY2F0aW9uIHNvdW5kIFVSTCAobXAzIGhvdGxpbmspXCIsIHR5cGU6IFwidGV4dFwiLCB2YWx1ZTogXCJodHRwczovL2dpdGh1Yi5jb20vYWxiZXJ0LXN1bi90YW1wZXItc2NyaXB0cy9ibG9iL21haW4vcmVzb3VyY2VzL25vdGlmaWNhdGlvbi5tcDM/cmF3PXRydWVcIiB9LFxyXG4gICAgICAgIHsga2V5OiBcInRlc3ROb3RpZmljYXRpb25Tb3VuZFwiLCBkZXNjcmlwdGlvbjogXCJQbGF5IGN1cnJlbnQgbm90aWZpY2F0aW9uIHNvdW5kXCIsIHR5cGU6IFwiYnV0dG9uXCIsIGluc3RydWN0aW9uOiBcInRlc3ROb3RpZmljYXRpb25Tb3VuZFwiIH0sXHJcbiAgICBdXHJcbn07XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuY29uc3Qgd2ViZXh0ZW5zaW9uX3BvbHlmaWxsX3RzXzEgPSByZXF1aXJlKFwid2ViZXh0ZW5zaW9uLXBvbHlmaWxsLXRzXCIpO1xyXG5jb25zdCB1dGlsaXRpZXNfMSA9IHJlcXVpcmUoXCIuL3V0aWxpdGllc1wiKTtcclxuY29uc3QgY29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi9jb25zdGFudHNcIik7XHJcbi8vIEFzeW5jaHJvbm91c2x5IHVwZGF0ZXMgZXh0ZW5zaW9uIHN0b3JhZ2Ugd2l0aCBnaXZlbiBzZXR0aW5nIGFuZCBub3RpZnkgdGFicyBvZiB1cGRhdGVcclxuLy8gSXNzdWUgd2l0aCBub3RpZnlpbmcgdG8gcGFnZXMgbm90IHJlbG9hZGVkIHdoZW4gdXBkYXRpbmcgZXh0ZW5zaW9uIHNvdXJjZT9cclxuZnVuY3Rpb24gdXBkYXRlU2V0dGluZyhzZXR0aW5nS2V5LCBzZXR0aW5nVmFsdWUsIG5vdGlmeSA9IHRydWUpIHtcclxuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgeWllbGQgd2ViZXh0ZW5zaW9uX3BvbHlmaWxsX3RzXzEuYnJvd3Nlci5zdG9yYWdlLmxvY2FsLnNldCh7IFtgc2V0dGluZy0ke3NldHRpbmdLZXl9YF06IHNldHRpbmdWYWx1ZSB9KTtcclxuICAgICAgICBpZiAobm90aWZ5ID09PSB0cnVlKSB7IC8vIEVuYWJsZWQgYnkgZGVmYXVsdCBmb3IgY29udmVuaWVuY2VcclxuICAgICAgICAgICAgY29uc3QgdGFicyA9IHlpZWxkIHdlYmV4dGVuc2lvbl9wb2x5ZmlsbF90c18xLmJyb3dzZXIudGFicy5xdWVyeSh7fSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB7IFwiaW5zdHJ1Y3Rpb25cIjogXCJ1cGRhdGVkU2V0dGluZ1wiLCBcImFyZ3VtZW50c1wiOiBbc2V0dGluZ0tleSwgc2V0dGluZ1ZhbHVlXSB9O1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHRhYiBvZiB0YWJzKSB7IC8vIE5vdGlmeSBpbmRpdmlkdWFsIHRhYnMgb2YgdXBkYXRlZCBzZXR0aW5nXHJcbiAgICAgICAgICAgICAgICAvLyBQb2x5ZmlsbCB0aHJvd3MgZXJyb3IgaWYgbWlzc2luZyBsaXN0ZW5lciwgaWdub3JlXHJcbiAgICAgICAgICAgICAgICB3ZWJleHRlbnNpb25fcG9seWZpbGxfdHNfMS5icm93c2VyLnRhYnMuc2VuZE1lc3NhZ2UodGFiLmlkLCBtZXNzYWdlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbi8vIEZyb20gc2V0dGluZ3MgYnV0dG9ucywgYnJvYWRjYXN0IGdpdmVuIGluc3RydWN0aW9uIHRvIHRhYnNcclxuZnVuY3Rpb24gYnJvYWRjYXN0SW5zdHJ1Y3Rpb24oaW5zdHJ1Y3Rpb24sIGFyZ3MgPSBbXSkge1xyXG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCB0YWJzID0geWllbGQgd2ViZXh0ZW5zaW9uX3BvbHlmaWxsX3RzXzEuYnJvd3Nlci50YWJzLnF1ZXJ5KHt9KTtcclxuICAgICAgICBjb25zdCBtZXNzYWdlID0geyBcImluc3RydWN0aW9uXCI6IGluc3RydWN0aW9uLCBcImFyZ3VtZW50c1wiOiBhcmdzIH07XHJcbiAgICAgICAgZm9yIChjb25zdCB0YWIgb2YgdGFicykge1xyXG4gICAgICAgICAgICAvLyBXYWl0IGZvciByZXNwb25zZSBhbmQgcmV0dXJuIHdpdGggdGFicz9cclxuICAgICAgICAgICAgd2ViZXh0ZW5zaW9uX3BvbHlmaWxsX3RzXzEuYnJvd3Nlci50YWJzLnNlbmRNZXNzYWdlKHRhYi5pZCwgbWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuLy8gUmV0cmlldmUgZXhpc3Rpbmcgc2V0dGluZ3MgZnJvbSBzdG9yYWdlIGFuZCBwb3B1bGF0ZSBzZXR0aW5ncyB0YWJsZSBmb3IgY2F0ZWdvcnlcclxuZnVuY3Rpb24gcG9wdWxhdGVTZXR0aW5ncygpIHtcclxuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudFNldHRpbmdzID0gY29uc3RhbnRzXzEuZGVmYXVsdFNldHRpbmdzOyAvLyBCZWZvcmUgbW9kaWZpY2F0aW9uXHJcbiAgICAgICAgZm9yIChjb25zdCBbc2V0dGluZ3NDYXRlZ29yeSwgX10gb2YgT2JqZWN0LmVudHJpZXMoY3VycmVudFNldHRpbmdzKSkge1xyXG4gICAgICAgICAgICBjdXJyZW50U2V0dGluZ3Nbc2V0dGluZ3NDYXRlZ29yeV0gPSB5aWVsZCB1dGlsaXRpZXNfMS5yZXRyaWV2ZVNldHRpbmdzKHNldHRpbmdzQ2F0ZWdvcnkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBQb3B1bGF0ZSBhbGwgc2V0dGluZ3MgY2F0ZWdvcmllcyB0YWJsZXMgd2l0aGluIHNldHRpbmdzIHBhZ2VcclxuICAgICAgICBmb3IgKGNvbnN0IFtzZXR0aW5nc0NhdGVnb3J5LCBfXSBvZiBPYmplY3QuZW50cmllcyhjb25zdGFudHNfMS5kZWZhdWx0U2V0dGluZ3MpKSB7XHJcbiAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgZmFuY3kgdGFibGUgcm93cyBhbmQgc3R1ZmYsIGhhcyB0byBiZSBhIGNsZWFuZXIgd2F5P1xyXG4gICAgICAgICAgICBjb25zdCBzZXR0aW5nc1RhYmxlID0gJChgI3NldHRpbmdzLSR7c2V0dGluZ3NDYXRlZ29yeX1gKVswXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBzZXR0aW5nIG9mIGN1cnJlbnRTZXR0aW5nc1tzZXR0aW5nc0NhdGVnb3J5XSkge1xyXG4gICAgICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSByZWxldmFudCBlbGVtZW50cyBmb3Igc2V0dGluZ3NcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNldHRpbmdSb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidHJcIik7XHJcbiAgICAgICAgICAgICAgICBzZXR0aW5nUm93LmNsYXNzTGlzdC5hZGQoXCJ0YWJsZS1yb3dcIik7XHJcbiAgICAgICAgICAgICAgICBzZXR0aW5nc1RhYmxlLmFwcGVuZENoaWxkKHNldHRpbmdSb3cpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGVmdERlc2NyaXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRkXCIpO1xyXG4gICAgICAgICAgICAgICAgbGVmdERlc2NyaXB0aW9uLmNsYXNzTGlzdC5hZGQoXCJ0YWJsZS1lbGVtZW50LWxlZnRcIik7XHJcbiAgICAgICAgICAgICAgICBzZXR0aW5nUm93LmFwcGVuZENoaWxkKGxlZnREZXNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByaWdodERlc2NyaXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRkXCIpO1xyXG4gICAgICAgICAgICAgICAgcmlnaHREZXNjcmlwdGlvbi5jbGFzc0xpc3QuYWRkKFwidGFibGUtZWxlbWVudC1yaWdodFwiKTtcclxuICAgICAgICAgICAgICAgIHNldHRpbmdSb3cuYXBwZW5kQ2hpbGQocmlnaHREZXNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICAvLyBQYXJzZSBkZXNjcmlwdGlvbiBhbmQgaW5mb3JtYXRpb24gZnJvbSBzZXR0aW5nXHJcbiAgICAgICAgICAgICAgICAvLyBBbHNvIGF0dGFjaCBvbmNsaWNrIC8gb25jaGFuZ2UgY2FsbGJhY2tzIHRvIGNoYW5nZSBzZXR0aW5nc1xyXG4gICAgICAgICAgICAgICAgbGVmdERlc2NyaXB0aW9uLmlubmVyVGV4dCA9IHNldHRpbmcuZGVzY3JpcHRpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzZXR0aW5nS2V5ID0gYCR7c2V0dGluZ3NDYXRlZ29yeX0tJHtzZXR0aW5nLmtleX1gO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNldHRpbmdSaWdodDtcclxuICAgICAgICAgICAgICAgIGlmIChzZXR0aW5nLnR5cGUgPT09IFwiYnV0dG9uXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBCdXR0b24gdXN1YWxseSBmb3IgdGVzdGluZywgYnJvYWRjYXN0cyBzcGVjaWZpYyBpbnN0cnVjdGlvbiAoZW1wdHkgYXJndW1lbnRzKVxyXG4gICAgICAgICAgICAgICAgICAgIHNldHRpbmdSaWdodCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNldHRpbmdSaWdodC5jbGFzc0xpc3QuYWRkKFwidGFibGUtYnV0dG9uXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNldHRpbmdSaWdodC5ocmVmID0gXCIjXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ1JpZ2h0LmlubmVyVGV4dCA9IFwiQ2xpY2sgbWUhXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ1JpZ2h0Lm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyb2FkY2FzdEluc3RydWN0aW9uKHNldHRpbmcuaW5zdHJ1Y3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChzZXR0aW5nLnR5cGUgPT09IFwic2xpZGVTd2l0Y2hcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIENoZWNrYm94LCBhY3RzIG11Y2ggbGlrZSByZWd1bGFyIGlucHV0IHcvIGRpZmZlcmVudCBhdHRyaWJ1dGVzXHJcbiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ1JpZ2h0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNldHRpbmdSaWdodC5jbGFzc0xpc3QuYWRkKFwic3dpdGNoXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVuZGVyQ2hlY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ1JpZ2h0LmFwcGVuZENoaWxkKHVuZGVyQ2hlY2spO1xyXG4gICAgICAgICAgICAgICAgICAgIHVuZGVyQ2hlY2sudHlwZSA9IFwiY2hlY2tib3hcIjtcclxuICAgICAgICAgICAgICAgICAgICB1bmRlckNoZWNrLmNoZWNrZWQgPSBzZXR0aW5nLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICQodW5kZXJDaGVjaykuY2hhbmdlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlU2V0dGluZyhzZXR0aW5nS2V5LCB1bmRlckNoZWNrLmNoZWNrZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVuZGVyU3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVuZGVyU3Bhbi5jbGFzc0xpc3QuYWRkKFwic2xpZGVyXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVuZGVyU3Bhbi5jbGFzc0xpc3QuYWRkKFwicm91bmRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ1JpZ2h0LmFwcGVuZENoaWxkKHVuZGVyU3Bhbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHsgLy8gdGV4dCAvIG51bWJlciAvIGV0Yy5cclxuICAgICAgICAgICAgICAgICAgICAvLyBSZWd1bGFyIGlucHV0LCBhc3N1bWUgdmFsdWVzIGFyZSBwYXJzZWQgcHJvcGVybHlcclxuICAgICAgICAgICAgICAgICAgICBzZXR0aW5nUmlnaHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ1JpZ2h0LmNsYXNzTGlzdC5hZGQoXCJ0YWJsZS1pbnB1dFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBzZXR0aW5nUmlnaHQudHlwZSA9IHNldHRpbmcudHlwZTtcclxuICAgICAgICAgICAgICAgICAgICBzZXR0aW5nUmlnaHQudmFsdWUgPSBzZXR0aW5nLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICQoc2V0dGluZ1JpZ2h0KS5jaGFuZ2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVTZXR0aW5nKHNldHRpbmdLZXksIHNldHRpbmdSaWdodC52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByaWdodERlc2NyaXB0aW9uLmFwcGVuZENoaWxkKHNldHRpbmdSaWdodCk7XHJcbiAgICAgICAgICAgICAgICAvLyBBcHBlbmQgZXh0cmEgdGV4dCB0byBpbnB1dCAodGV4dCwgbnVtYmVyLCBldGMuKSB1c2luZyBhIHBhcmFncmFwaCBlbGVtZW50XHJcbiAgICAgICAgICAgICAgICBpZiAoKHNldHRpbmcudHlwZSAhPT0gXCJidXR0b25cIiAmJiBzZXR0aW5nLnR5cGUgIT09IFwiY2hlY2tib3hcIikgJiYgc2V0dGluZy5leHRyYVRleHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBleHRyYVRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBleHRyYVRleHQuY2xhc3NMaXN0LmFkZChcInRhYmxlLWV4dHJhXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV4dHJhVGV4dC50ZXh0Q29udGVudCA9IHNldHRpbmcuZXh0cmFUZXh0O1xyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0RGVzY3JpcHRpb24uYXBwZW5kQ2hpbGQoZXh0cmFUZXh0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbnBvcHVsYXRlU2V0dGluZ3MoKTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLnJldHJpZXZlU2V0dGluZ3NLViA9IGV4cG9ydHMucmV0cmlldmVTZXR0aW5ncyA9IGV4cG9ydHMuc3RvcmFnZUdldCA9IGV4cG9ydHMuZWxlbWVudENvbG9yID0gZXhwb3J0cy5zbGVlcCA9IHZvaWQgMDtcclxuY29uc3Qgd2ViZXh0ZW5zaW9uX3BvbHlmaWxsX3RzXzEgPSByZXF1aXJlKFwid2ViZXh0ZW5zaW9uLXBvbHlmaWxsLXRzXCIpO1xyXG5jb25zdCBjb25zdGFudHNfMSA9IHJlcXVpcmUoXCIuL2NvbnN0YW50c1wiKTtcclxuLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvOTUxMDIxL3doYXQtaXMtdGhlLWphdmFzY3JpcHQtdmVyc2lvbi1vZi1zbGVlcFxyXG4vLyBQb3NzaWJseSBoYXMgaXNzdWVzIHJlc29sdmluZyBvbiBGaXJlZm94PyBTdGFja092ZXJmbG93IHN1cmUgZG9lc24ndCB0aGluayBzby4uLlxyXG5mdW5jdGlvbiBzbGVlcChtcykge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xyXG59XHJcbmV4cG9ydHMuc2xlZXAgPSBzbGVlcDtcclxuLy8gQXBwcm94aW1hdGVzIHRoZSByZW5kZXJlZCBiYWNrZ3JvdW5kIGNvbG9yIG9mIGEgZ2l2ZW4gZWxlbWVudCB0byBhIGdpdmVuIHNldCBvZiBjb2xvcnMuXHJcbi8vIENoZWNrcyB3aGV0aGVyIHRoZSBcImRpc3RhbmNlXCIgZnJvbSB0aGUgZWxlbWVudCBjb2xvciBpcyB0cmFuc3BhcmVudCBvciBjbG9zZXN0IHRvIGVpdGhlciB5ZWxsb3cvd2hpdGUvYmx1ZS5cclxuY29uc3QgY29sb3JzID0gW1xyXG4gICAgeyBjb2xvcjogXCJ5ZWxsb3dcIiwgcjogMjU1LCBnOiAyMjQsIGI6IDAgfSxcclxuICAgIHsgY29sb3I6IFwiYmx1ZVwiLCByOiAwLCBnOiAzMCwgYjogMTE1IH0sXHJcbiAgICB7IGNvbG9yOiBcImdyZXlcIiwgcjogMTk3LCBnOiAyMDMsIGI6IDIxMyB9LFxyXG4gICAgeyBjb2xvcjogXCJ3aGl0ZVwiLCByOiAyNTUsIGc6IDI1NSwgYjogMjU1IH0sXHJcbl07XHJcbmZ1bmN0aW9uIGVsZW1lbnRDb2xvcihlbGVtZW50KSB7XHJcbiAgICAvLyBHZXQgdGhlIHJlbmRlcmVkIGJhY2tncm91bmQgY29sb3Igb2YgdGhlIGVsZW1lbnRcclxuICAgIGNvbnN0IGNvbG9yVGV4dCA9IGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCwgbnVsbCkuZ2V0UHJvcGVydHlWYWx1ZShcImJhY2tncm91bmQtY29sb3JcIik7XHJcbiAgICBpZiAoY29sb3JUZXh0LmluY2x1ZGVzKFwicmdiKDAsIDAsIDBcIikpIHsgLy8gZWxlbWVudCBoYXMgbm8gY29sb3IgPSB0cmFuc3BhcmVudFxyXG4gICAgICAgIHJldHVybiBcInRyYW5zcGFyZW50XCI7XHJcbiAgICB9XHJcbiAgICAvLyBQYXJzZSBSR0IgdmFsdWUgYW5kIHVzZSBmYW5jeSBtYXRocyB0byBmaW5kIGNsb3Nlc3QgY29sb3JcclxuICAgIGNvbnN0IHBhcnNlZENvbG9yID0geyByOiAwLCBnOiAwLCBiOiAwIH07XHJcbiAgICBjb25zdCBtYXRjaGVkQ29sb3IgPSBjb2xvclRleHQubWF0Y2goL15yZ2JcXHMqXFwoXFxzKihcXGQrKVxccyosXFxzKihcXGQrKVxccyosXFxzKihcXGQrKVxccypcXCkkL2kpO1xyXG4gICAgcGFyc2VkQ29sb3IuciA9IE51bWJlcihtYXRjaGVkQ29sb3JbMV0pO1xyXG4gICAgcGFyc2VkQ29sb3IuZyA9IE51bWJlcihtYXRjaGVkQ29sb3JbMl0pO1xyXG4gICAgcGFyc2VkQ29sb3IuYiA9IE51bWJlcihtYXRjaGVkQ29sb3JbM10pO1xyXG4gICAgY29uc3QgY2xvc2VzdCA9IHsgY29sb3I6IFwiXCIsIGRpc3RhbmNlOiA0NDIgfTsgLy8gRGVmYXVsdCBkaXN0YW5jZSBqdXN0IHNsaWdodGx5IGxhcmdlciB0aGFuIG1heFxyXG4gICAgZm9yIChjb25zdCBjaGVja0NvbG9yIG9mIGNvbG9ycykge1xyXG4gICAgICAgIGNvbnN0IGRpc3RhbmNlID0gTWF0aC5zcXJ0KE1hdGgucG93KChwYXJzZWRDb2xvci5yIC0gY2hlY2tDb2xvci5yKSwgMikgKyBNYXRoLnBvdygocGFyc2VkQ29sb3IuZyAtIGNoZWNrQ29sb3IuZyksIDIpICsgKHBhcnNlZENvbG9yLmIgLSBjaGVja0NvbG9yLmIpKTtcclxuICAgICAgICBpZiAoZGlzdGFuY2UgPCBjbG9zZXN0LmRpc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIGNsb3Nlc3QuY29sb3IgPSBjaGVja0NvbG9yLmNvbG9yO1xyXG4gICAgICAgICAgICBjbG9zZXN0LmRpc3RhbmNlID0gZGlzdGFuY2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNsb3Nlc3QuY29sb3I7XHJcbn1cclxuZXhwb3J0cy5lbGVtZW50Q29sb3IgPSBlbGVtZW50Q29sb3I7XHJcbi8vIFdyYXBwZXIgZm9yIHJldHJpZXZpbmcgZnJvbSBzdG9yYWdlIHdpdGggZGVmYXVsdCB2YWx1ZSBpZiB1bmRlZmluZWRcclxuZnVuY3Rpb24gc3RvcmFnZUdldChzdG9yYWdlS2V5LCBkZWZhdWx0VmFsdWUpIHtcclxuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uc3Qgc3RvcmFnZVJlc3VsdCA9IHlpZWxkIHdlYmV4dGVuc2lvbl9wb2x5ZmlsbF90c18xLmJyb3dzZXIuc3RvcmFnZS5sb2NhbC5nZXQoc3RvcmFnZUtleSk7XHJcbiAgICAgICAgcmV0dXJuIHN0b3JhZ2VSZXN1bHRbc3RvcmFnZUtleV0gIT09IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICA/IHN0b3JhZ2VSZXN1bHRbc3RvcmFnZUtleV0gOiBkZWZhdWx0VmFsdWU7XHJcbiAgICB9KTtcclxufVxyXG5leHBvcnRzLnN0b3JhZ2VHZXQgPSBzdG9yYWdlR2V0O1xyXG4vLyBXcmFwcGVyIGZvciByZXRyaWV2aW5nIHNldHRpbmdzIGZvciBnaXZlbiBjYXRlZ29yeSBieSB1cGRhdGluZyBmcm9tIFN0b3JhZ2UgQVBJXHJcbmZ1bmN0aW9uIHJldHJpZXZlU2V0dGluZ3Moc2V0dGluZ3NDYXRlZ29yeSkge1xyXG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAvLyBHZXQgZGVmYXVsdCBzZXR0aW5ncywgdGhlbiB1cGRhdGUgaW5kaXZpZHVhbCBzZXR0aW5ncyBmcm9tIFN0b3JhZ2UgQVBJXHJcbiAgICAgICAgY29uc3QgY2F0ZWdvcnlTZXR0aW5ncyA9IGNvbnN0YW50c18xLmRlZmF1bHRTZXR0aW5nc1tzZXR0aW5nc0NhdGVnb3J5XTtcclxuICAgICAgICBmb3IgKGNvbnN0IHNldHRpbmcgb2YgY2F0ZWdvcnlTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAvLyBJZ25vcmUgc2V0dGluZ3Mgd2l0aG91dCBhIHZhbHVlIChidXR0b25zIG1haW5seSlcclxuICAgICAgICAgICAgaWYgKHNldHRpbmcudmFsdWUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gUmVwbGFjZSB3aXRoIHZhbHVlIGZyb20gc3RvcmFnZSBpZiBtb2RpZmllZCBleGlzdHMsIG90aGVyd2lzZSBrZWVwIGRlZmF1bHRcclxuICAgICAgICAgICAgY29uc3Qgc2V0dGluZ0tleSA9IGBzZXR0aW5nLSR7c2V0dGluZ3NDYXRlZ29yeX0tJHtzZXR0aW5nLmtleX1gO1xyXG4gICAgICAgICAgICBzZXR0aW5nLnZhbHVlID0geWllbGQgc3RvcmFnZUdldChzZXR0aW5nS2V5LCBzZXR0aW5nLnZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNhdGVnb3J5U2V0dGluZ3M7XHJcbiAgICB9KTtcclxufVxyXG5leHBvcnRzLnJldHJpZXZlU2V0dGluZ3MgPSByZXRyaWV2ZVNldHRpbmdzO1xyXG4vLyBXcmFwcGVyIGZvciBmb3JtYXR0aW5nIHRoZSBzZXR0aW5ncyBpbnRvIGtleS12YWx1ZSBpbnN0ZWFkIG9mIGFycmF5XHJcbmZ1bmN0aW9uIHJldHJpZXZlU2V0dGluZ3NLVihzZXR0aW5nc0NhdGVnb3J5KSB7XHJcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3J5U2V0dGluZ3NLViA9IHt9O1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3J5U2V0dGluZ3MgPSB5aWVsZCByZXRyaWV2ZVNldHRpbmdzKHNldHRpbmdzQ2F0ZWdvcnkpOyAvLyBHZXQgc2V0dGluZ3MgYmVmb3JlIHJlZm9ybWF0dGluZ1xyXG4gICAgICAgIGZvciAoY29uc3Qgc2V0dGluZyBvZiBjYXRlZ29yeVNldHRpbmdzKSB7XHJcbiAgICAgICAgICAgIC8vIElnbm9yZSBzZXR0aW5ncyB3aXRob3V0IGEgdmFsdWUgKGJ1dHRvbnMgbWFpbmx5KVxyXG4gICAgICAgICAgICBpZiAoc2V0dGluZy52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRlZ29yeVNldHRpbmdzS1Zbc2V0dGluZy5rZXldID0gc2V0dGluZztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNhdGVnb3J5U2V0dGluZ3NLVjtcclxuICAgIH0pO1xyXG59XHJcbmV4cG9ydHMucmV0cmlldmVTZXR0aW5nc0tWID0gcmV0cmlldmVTZXR0aW5nc0tWO1xyXG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbl9fd2VicGFja19yZXF1aXJlX18ubSA9IF9fd2VicGFja19tb2R1bGVzX187XG5cbiIsIi8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSAobW9kdWxlKSA9PiB7XG5cdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuXHRcdCgpID0+IChtb2R1bGVbJ2RlZmF1bHQnXSkgOlxuXHRcdCgpID0+IChtb2R1bGUpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCB7IGE6IGdldHRlciB9KTtcblx0cmV0dXJuIGdldHRlcjtcbn07IiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5qID0gNDM2OyIsIi8vIG5vIGJhc2VVUklcblxuLy8gb2JqZWN0IHRvIHN0b3JlIGxvYWRlZCBhbmQgbG9hZGluZyBjaHVua3Ncbi8vIHVuZGVmaW5lZCA9IGNodW5rIG5vdCBsb2FkZWQsIG51bGwgPSBjaHVuayBwcmVsb2FkZWQvcHJlZmV0Y2hlZFxuLy8gW3Jlc29sdmUsIHJlamVjdCwgUHJvbWlzZV0gPSBjaHVuayBsb2FkaW5nLCAwID0gY2h1bmsgbG9hZGVkXG52YXIgaW5zdGFsbGVkQ2h1bmtzID0ge1xuXHQ0MzY6IDAsXG5cdDUzMzogMCxcblx0Mzg2OiAwXG59O1xuXG4vLyBubyBjaHVuayBvbiBkZW1hbmQgbG9hZGluZ1xuXG4vLyBubyBwcmVmZXRjaGluZ1xuXG4vLyBubyBwcmVsb2FkZWRcblxuLy8gbm8gSE1SXG5cbi8vIG5vIEhNUiBtYW5pZmVzdFxuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLk8uaiA9IChjaHVua0lkKSA9PiAoaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID09PSAwKTtcblxuLy8gaW5zdGFsbCBhIEpTT05QIGNhbGxiYWNrIGZvciBjaHVuayBsb2FkaW5nXG52YXIgd2VicGFja0pzb25wQ2FsbGJhY2sgPSAocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24sIGRhdGEpID0+IHtcblx0dmFyIFtjaHVua0lkcywgbW9yZU1vZHVsZXMsIHJ1bnRpbWVdID0gZGF0YTtcblx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG5cdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuXHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwO1xuXHRmb3IobW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8obW9yZU1vZHVsZXMsIG1vZHVsZUlkKSkge1xuXHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcblx0XHR9XG5cdH1cblx0aWYocnVudGltZSkgdmFyIHJlc3VsdCA9IHJ1bnRpbWUoX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cdGlmKHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uKSBwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbihkYXRhKTtcblx0Zm9yKDtpIDwgY2h1bmtJZHMubGVuZ3RoOyBpKyspIHtcblx0XHRjaHVua0lkID0gY2h1bmtJZHNbaV07XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkgJiYgaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdKSB7XG5cdFx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1bMF0oKTtcblx0XHR9XG5cdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRzW2ldXSA9IDA7XG5cdH1cblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uTyhyZXN1bHQpO1xufVxuXG52YXIgY2h1bmtMb2FkaW5nR2xvYmFsID0gc2VsZltcIndlYnBhY2tDaHVua2V4dGVuc2lvblwiXSA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmtleHRlbnNpb25cIl0gfHwgW107XG5jaHVua0xvYWRpbmdHbG9iYWwuZm9yRWFjaCh3ZWJwYWNrSnNvbnBDYWxsYmFjay5iaW5kKG51bGwsIDApKTtcbmNodW5rTG9hZGluZ0dsb2JhbC5wdXNoID0gd2VicGFja0pzb25wQ2FsbGJhY2suYmluZChudWxsLCBjaHVua0xvYWRpbmdHbG9iYWwucHVzaC5iaW5kKGNodW5rTG9hZGluZ0dsb2JhbCkpOyIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgZGVwZW5kcyBvbiBvdGhlciBsb2FkZWQgY2h1bmtzIGFuZCBleGVjdXRpb24gbmVlZCB0byBiZSBkZWxheWVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18uTyh1bmRlZmluZWQsIFs3MzZdLCAoKSA9PiAoX193ZWJwYWNrX3JlcXVpcmVfXyg3MzUpKSlcbl9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fLk8oX193ZWJwYWNrX2V4cG9ydHNfXyk7XG4iXSwic291cmNlUm9vdCI6IiJ9