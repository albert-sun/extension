(()=>{"use strict";var e,t={9705:function(e,t,i){var o=this&&this.__awaiter||function(e,t,i,o){return new(i||(i=Promise))((function(n,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function l(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,l)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=i(9416),r=i(1209);let s,l={},a={notificationSoundURL:function(){return o(this,void 0,void 0,(function*(){s=new Audio(l.notificationSoundURL.value)}))},whitelistedKeywords:function(){return o(this,void 0,void 0,(function*(){c=l.whitelistedKeywords.value.split(",").map((e=>e.trim().toLowerCase())).filter((e=>""!=e))}))},blacklistedKeywords:function(){return o(this,void 0,void 0,(function*(){d=l.blacklistedKeywords.value.split(",").map((e=>e.trim().toLowerCase())).filter((e=>""!=e))}))}},u={updatedSetting:function(e,t){return o(this,void 0,void 0,(function*(){const[i,o]=e.split("-");"bestbuy"===i&&(l[o].value=t,yield a[o]())}))},testNotificationSound:function(){return o(this,void 0,void 0,(function*(){s.play()}))}},c=[],d=[],p=[],f=0,v=0;!function(){o(this,void 0,void 0,(function*(){l=yield r.retrieveSettingsKV("bestbuy");for(const[e,t]of Object.entries(a))yield t();n.browser.runtime.onMessage.addListener((function(e,t){return o(this,void 0,void 0,(function*(){const t=u[e.instruction];if(void 0!==t)return yield t(...e.arguments||[])}))}));const e={data:atob(localStorage.getItem("purchaseTracker")||"e30="),time:Number(new Date)};yield n.browser.storage.local.set({"bestbuy-queueInfo":e}),n.browser.runtime.sendMessage({instruction:"updatedQueueInfo",arguments:[e]}),yield function(){return o(this,void 0,void 0,(function*(){for(;0===$(".page-heading__title").length;)yield r.sleep(l.globalPollingInterval.value);const e=$(".item-list")[0];for(f=void 0!==e?e.childNodes.length:0;;){for(;$(".page-spinner--in").length>0;)yield r.sleep(l.globalPollingInterval.value);const e=$(".item-list")[0],t=void 0!==e?e.childNodes.length:0;if(t>f&&s.play(),f=t,t>0&&!0===l.stopClickCartOccupied.value){yield r.sleep(l.globalPollingInterval.value);continue}if(!1===p.some((e=>$.contains(document.body,e.wrapper)))){let e=$(".saved-items__card-wrapper").toArray();for(;0===e.length;)yield r.sleep(l.globalPollingInterval.value),e=$(".saved-items__card-wrapper").toArray();p=e.map((function(e){return{wrapper:e,sku:e.getAttribute("data-test-saved-sku"),description:$(e).find(".simple-item__description")[0].innerText,addButton:$(e).find(".btn")[0]}}))}const i=p.filter((e=>c.some((t=>""!==t&&e.description.toLowerCase().includes(t))))).filter((e=>d.every((t=>!e.description.toLowerCase().includes(t)))));for(const e of i){const t=r.elementColor(e.addButton);if(!0===["white","blue","yellow"].includes(t)){const t=Number(new Date)-v;!0===l.autoClickWhitelisted.value&&t>l.successiveClickTimeout.value&&(e.addButton.click(),v=Number(new Date))}}yield r.sleep(l.globalPollingInterval.value)}}))}()}))}()},8681:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSettings=t.changelogs=void 0,t.changelogs=[{version:"b0.2.1",bulletpoints:["Fixed empty blacklist disqualifying all saved items",'Replaced icon which said "AQU" instead of "AGU" (original extension name was AutoQueueUtilities)',"<b>TODO:</b> Fix notification sound not playing if user hasn't interacted with document, maybe play from background instead?"]},{version:"b0.2.0",bulletpoints:["Added About tab showing some information and usage instructions","Changed extension icon to something somewhat more presentable","Removed placeholder logging tab pending further development","Added blacklisted keywords functionality to script (still no test buttons)","Other minor edits to extension popup styling, nothing too major"]},{version:"b0.1.0",bulletpoints:["Added changelog (this tab here) and placeholder logging tab for testing","Changed extension script loading to work somewhat more dynamically"]},{version:"b0.0.1",bulletpoints:['Ported most functionality from Tampermonkey script located <a href="https://github.com/albert-sun/tamper-scripts/">here</a>',"<b>Features not yet implemented</b>: blacklisted keywords and buttons for testing wtihin settings (removed until settings structure finalized)","<b>Improvements from Tampermonkey script</b>: Instant settings propogation and no refresh required for cart addition or removal"]}],t.defaultSettings={bestbuy:[{key:"automaticQueueFix",description:"Attempt to automatically fix broken queues",type:"slideSwitch",value:!0},{key:"autoClickWhitelisted",description:"Automatically click whitelisted ATC buttons",type:"slideSwitch",value:!0},{key:"stopClickCartOccupied",description:"Stop automatic clicking when cart occupied",type:"slideSwitch",value:!0},{key:"globalPollingInterval",description:"Global content script polling interval",type:"number",extraText:"ms",value:100},{key:"successiveClickTimeout",description:"Timeout between clicking unique buttons",type:"number",extraText:"ms",value:2500},{key:"notificationSoundURL",description:"Notification sound URL (mp3 hotlink)",type:"text",value:"https://github.com/albert-sun/tamper-scripts/blob/main/resources/notification.mp3?raw=true"},{key:"whitelistedKeywords",description:"Whitelisted keywords (comma-separated)",type:"text",value:"3060,3060ti,3060 ti,3070,3070ti,3070 ti,3080,3080ti,3080 ti,3090"},{key:"blacklistedKeywords",description:"Blacklisted keywords (comma-separated)",type:"text",value:""}]}},1209:function(e,t,i){var o=this&&this.__awaiter||function(e,t,i,o){return new(i||(i=Promise))((function(n,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function l(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,l)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveSettingsKV=t.retrieveSettings=t.storageGet=t.elementColor=t.sleep=void 0;const n=i(9416),r=i(8681);t.sleep=function(e){return new Promise((t=>setTimeout(t,e)))};const s=[{color:"yellow",r:255,g:224,b:0},{color:"blue",r:0,g:30,b:115},{color:"grey",r:197,g:203,b:213},{color:"white",r:255,g:255,b:255}];function l(e,t){return o(this,void 0,void 0,(function*(){const i=yield n.browser.storage.local.get(e);return void 0!==i[e]?i[e]:t}))}function a(e){return o(this,void 0,void 0,(function*(){const t=r.defaultSettings[e];for(const i of t){if(void 0===i.value)continue;const t=`setting-${e}-${i.key}`;i.value=yield l(t,i.value)}return t}))}t.elementColor=function(e){const t=getComputedStyle(e,null).getPropertyValue("background-color");if(t.includes("rgb(0, 0, 0"))return"transparent";const i={r:0,g:0,b:0},o=t.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i);i.r=Number(o[1]),i.g=Number(o[2]),i.b=Number(o[3]);const n={color:"",distance:442};for(const e of s){const t=Math.sqrt(Math.pow(i.r-e.r,2)+Math.pow(i.g-e.g,2)+(i.b-e.b));t<n.distance&&(n.color=e.color,n.distance=t)}return n.color},t.storageGet=l,t.retrieveSettings=a,t.retrieveSettingsKV=function(e){return o(this,void 0,void 0,(function*(){const t={},i=yield a(e);for(const e of i)void 0!==e.value&&(t[e.key]=e);return t}))}}},i={};function o(e){var n=i[e];if(void 0!==n)return n.exports;var r=i[e]={exports:{}};return t[e].call(r.exports,r,r.exports,o),r.exports}o.m=t,e=[],o.O=(t,i,n,r)=>{if(!i){var s=1/0;for(u=0;u<e.length;u++){for(var[i,n,r]=e[u],l=!0,a=0;a<i.length;a++)(!1&r||s>=r)&&Object.keys(o.O).every((e=>o.O[e](i[a])))?i.splice(a--,1):(l=!1,r<s&&(s=r));l&&(e.splice(u--,1),t=n())}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[i,n,r]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var i in t)o.o(t,i)&&!o.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.j=843,(()=>{var e={843:0,533:0,386:0};o.O.j=t=>0===e[t];var t=(t,i)=>{var n,r,[s,l,a]=i,u=0;for(n in l)o.o(l,n)&&(o.m[n]=l[n]);if(a)var c=a(o);for(t&&t(i);u<s.length;u++)r=s[u],o.o(e,r)&&e[r]&&e[r][0](),e[s[u]]=0;return o.O(c)},i=self.webpackChunkextension=self.webpackChunkextension||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var n=o.O(void 0,[736],(()=>o(9705)));n=o.O(n)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leHRlbnNpb24vd2VicGFjay9ydW50aW1lL2NodW5rIGxvYWRlZCIsIndlYnBhY2s6Ly9leHRlbnNpb24vLi9zb3VyY2UvYmVzdGJ1eV9jYXJ0LnRzIiwid2VicGFjazovL2V4dGVuc2lvbi8uL3NvdXJjZS9jb25zdGFudHMudHMiLCJ3ZWJwYWNrOi8vZXh0ZW5zaW9uLy4vc291cmNlL3V0aWxpdGllcy50cyIsIndlYnBhY2s6Ly9leHRlbnNpb24vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vZXh0ZW5zaW9uL3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovL2V4dGVuc2lvbi93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vZXh0ZW5zaW9uL3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vZXh0ZW5zaW9uL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vZXh0ZW5zaW9uL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vZXh0ZW5zaW9uL3dlYnBhY2svcnVudGltZS9ydW50aW1lSWQiLCJ3ZWJwYWNrOi8vZXh0ZW5zaW9uL3dlYnBhY2svcnVudGltZS9qc29ucCBjaHVuayBsb2FkaW5nIiwid2VicGFjazovL2V4dGVuc2lvbi93ZWJwYWNrL3N0YXJ0dXAiXSwibmFtZXMiOlsiZGVmZXJyZWQiLCJfX2F3YWl0ZXIiLCJ0aGlzIiwidGhpc0FyZyIsIl9hcmd1bWVudHMiLCJQIiwiZ2VuZXJhdG9yIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJmdWxmaWxsZWQiLCJ2YWx1ZSIsInN0ZXAiLCJuZXh0IiwiZSIsInJlamVjdGVkIiwicmVzdWx0IiwiZG9uZSIsInRoZW4iLCJhcHBseSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsIndlYmV4dGVuc2lvbl9wb2x5ZmlsbF90c18xIiwidXRpbGl0aWVzXzEiLCJub3RpZmljYXRpb25Tb3VuZCIsImNhdGVnb3J5U2V0dGluZ3MiLCJ1cGRhdGVkU2V0dGluZ0hhbmRsZXJzIiwiQXVkaW8iLCJ3aGl0ZWxpc3RlZEtleXdvcmRzIiwic3BsaXQiLCJtYXAiLCJrZXl3b3JkIiwidHJpbSIsInRvTG93ZXJDYXNlIiwiZmlsdGVyIiwiYmxhY2tsaXN0ZWRLZXl3b3JkcyIsIm1lc3NhZ2VIYW5kbGVycyIsImZ1bGxTZXR0aW5nc0tleSIsImNhdGVnb3J5Iiwic2V0dGluZ3NLZXkiLCJwbGF5Iiwic2F2ZWRJdGVtcyIsInByZXZpb3VzQ2FydExlbmd0aCIsImxhc3RDbGlja2VkVGltZSIsInJldHJpZXZlU2V0dGluZ3NLViIsIl8iLCJ1cGRhdGVkU2V0dGluZ0hhbmRsZXIiLCJlbnRyaWVzIiwiYnJvd3NlciIsInJ1bnRpbWUiLCJvbk1lc3NhZ2UiLCJhZGRMaXN0ZW5lciIsIm1lc3NhZ2UiLCJzZW5kZXIiLCJoYW5kbGVyIiwiaW5zdHJ1Y3Rpb24iLCJ1bmRlZmluZWQiLCJhcmd1bWVudHMiLCJxdWV1ZUluZm8iLCJkYXRhIiwiYXRvYiIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJ0aW1lIiwiTnVtYmVyIiwiRGF0ZSIsInN0b3JhZ2UiLCJsb2NhbCIsInNldCIsInNlbmRNZXNzYWdlIiwiJCIsImxlbmd0aCIsInNsZWVwIiwiaW5pdENhcnRXcmFwcGVyIiwiY2hpbGROb2RlcyIsImNhcnRXcmFwcGVyIiwiY3VycmVudENhcnRMZW5ndGgiLCJzb21lIiwiaXRlbURhdGEiLCJjb250YWlucyIsImRvY3VtZW50IiwiYm9keSIsIndyYXBwZXIiLCJzYXZlZEVsZW1lbnRzIiwidG9BcnJheSIsImVsZW1lbnQiLCJza3UiLCJnZXRBdHRyaWJ1dGUiLCJkZXNjcmlwdGlvbiIsImZpbmQiLCJpbm5lclRleHQiLCJhZGRCdXR0b24iLCJmaWx0ZXJlZFNhdmVkSXRlbXMiLCJzYXZlZEl0ZW0iLCJpbmNsdWRlcyIsImV2ZXJ5IiwiYnV0dG9uQ29sb3IiLCJlbGVtZW50Q29sb3IiLCJzaW5jZUxhc3RDbGljayIsImNsaWNrIiwic2F2ZWRDYXJ0UnVudGltZSIsImRlZmF1bHRTZXR0aW5ncyIsImNoYW5nZWxvZ3MiLCJrZXkiLCJ0eXBlIiwiZXh0cmFUZXh0IiwicmV0cmlldmVTZXR0aW5ncyIsInN0b3JhZ2VHZXQiLCJjb25zdGFudHNfMSIsIm1zIiwic2V0VGltZW91dCIsImNvbG9ycyIsImNvbG9yIiwiciIsImciLCJiIiwic3RvcmFnZUtleSIsImRlZmF1bHRWYWx1ZSIsInN0b3JhZ2VSZXN1bHQiLCJnZXQiLCJzZXR0aW5nc0NhdGVnb3J5Iiwic2V0dGluZyIsInNldHRpbmdLZXkiLCJjb2xvclRleHQiLCJnZXRDb21wdXRlZFN0eWxlIiwiZ2V0UHJvcGVydHlWYWx1ZSIsInBhcnNlZENvbG9yIiwibWF0Y2hlZENvbG9yIiwibWF0Y2giLCJjbG9zZXN0IiwiZGlzdGFuY2UiLCJjaGVja0NvbG9yIiwiTWF0aCIsInNxcnQiLCJwb3ciLCJjYXRlZ29yeVNldHRpbmdzS1YiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiY2FsbCIsIm0iLCJPIiwiY2h1bmtJZHMiLCJmbiIsInByaW9yaXR5Iiwibm90RnVsZmlsbGVkIiwiSW5maW5pdHkiLCJpIiwiaiIsImtleXMiLCJzcGxpY2UiLCJuIiwiZ2V0dGVyIiwiX19lc01vZHVsZSIsImQiLCJhIiwiZGVmaW5pdGlvbiIsIm8iLCJlbnVtZXJhYmxlIiwiZ2xvYmFsVGhpcyIsIkZ1bmN0aW9uIiwid2luZG93Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJpbnN0YWxsZWRDaHVua3MiLCJjaHVua0lkIiwid2VicGFja0pzb25wQ2FsbGJhY2siLCJwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbiIsIm1vcmVNb2R1bGVzIiwiY2h1bmtMb2FkaW5nR2xvYmFsIiwic2VsZiIsImZvckVhY2giLCJiaW5kIiwicHVzaCIsIl9fd2VicGFja19leHBvcnRzX18iXSwibWFwcGluZ3MiOiJ1QkFBSUEsRSx3QkNDSixJQUFJQyxFQUFhQyxNQUFRQSxLQUFLRCxXQUFjLFNBQVVFLEVBQVNDLEVBQVlDLEVBQUdDLEdBRTFFLE9BQU8sSUFBS0QsSUFBTUEsRUFBSUUsV0FBVSxTQUFVQyxFQUFTQyxHQUMvQyxTQUFTQyxFQUFVQyxHQUFTLElBQU1DLEVBQUtOLEVBQVVPLEtBQUtGLElBQVcsTUFBT0csR0FBS0wsRUFBT0ssSUFDcEYsU0FBU0MsRUFBU0osR0FBUyxJQUFNQyxFQUFLTixFQUFpQixNQUFFSyxJQUFXLE1BQU9HLEdBQUtMLEVBQU9LLElBQ3ZGLFNBQVNGLEVBQUtJLEdBSmxCLElBQWVMLEVBSWFLLEVBQU9DLEtBQU9ULEVBQVFRLEVBQU9MLFFBSjFDQSxFQUl5REssRUFBT0wsTUFKaERBLGFBQWlCTixFQUFJTSxFQUFRLElBQUlOLEdBQUUsU0FBVUcsR0FBV0EsRUFBUUcsT0FJVE8sS0FBS1IsRUFBV0ssR0FDbEdILEdBQU1OLEVBQVlBLEVBQVVhLE1BQU1oQixFQUFTQyxHQUFjLEtBQUtTLFlBR3RFTyxPQUFPQyxlQUFlQyxFQUFTLGFBQWMsQ0FBRVgsT0FBTyxJQUN0RCxNQUFNWSxFQUE2QixFQUFRLE1BQ3JDQyxFQUFjLEVBQVEsTUFDNUIsSUFxQ0lDLEVBckNBQyxFQUFtQixHQUNuQkMsRUFBeUIsQ0FDekIscUJBQXdCLFdBQ3BCLE9BQU8xQixFQUFVQyxVQUFNLE9BQVEsR0FBUSxZQUNuQ3VCLEVBQW9CLElBQUlHLE1BQU1GLEVBQXVDLHFCQUFFZixXQUcvRSxvQkFBdUIsV0FDbkIsT0FBT1YsRUFBVUMsVUFBTSxPQUFRLEdBQVEsWUFDbkMyQixFQUFzQkgsRUFBc0Msb0JBQUVmLE1BQ3pEbUIsTUFBTSxLQUFLQyxLQUFL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YixFQUFvQk8sRUFBRWpJLElBRzFCaUssRUFBcUJDLEtBQTRCLHNCQUFJQSxLQUE0Qix1QkFBSyxHQUMxRkQsRUFBbUJFLFFBQVFMLEVBQXFCTSxLQUFLLEtBQU0sSUFDM0RILEVBQW1CSSxLQUFPUCxFQUFxQk0sS0FBSyxLQUFNSCxFQUFtQkksS0FBS0QsS0FBS0gsSyxHQzdDdkYsSUFBSUssRUFBc0I1QyxFQUFvQk8sT0FBRXhGLEVBQVcsQ0FBQyxNQUFNLElBQU9pRixFQUFvQixRQUM3RjRDLEVBQXNCNUMsRUFBb0JPLEVBQUVxQyxJIiwiZmlsZSI6InNvdXJjZS9iZXN0YnV5X2NhcnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZGVmZXJyZWQgPSBbXTtcbl9fd2VicGFja19yZXF1aXJlX18uTyA9IChyZXN1bHQsIGNodW5rSWRzLCBmbiwgcHJpb3JpdHkpID0+IHtcblx0aWYoY2h1bmtJZHMpIHtcblx0XHRwcmlvcml0eSA9IHByaW9yaXR5IHx8IDA7XG5cdFx0Zm9yKHZhciBpID0gZGVmZXJyZWQubGVuZ3RoOyBpID4gMCAmJiBkZWZlcnJlZFtpIC0gMV1bMl0gPiBwcmlvcml0eTsgaS0tKSBkZWZlcnJlZFtpXSA9IGRlZmVycmVkW2kgLSAxXTtcblx0XHRkZWZlcnJlZFtpXSA9IFtjaHVua0lkcywgZm4sIHByaW9yaXR5XTtcblx0XHRyZXR1cm47XG5cdH1cblx0dmFyIG5vdEZ1bGZpbGxlZCA9IEluZmluaXR5O1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IGRlZmVycmVkLmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIFtjaHVua0lkcywgZm4sIHByaW9yaXR5XSA9IGRlZmVycmVkW2ldO1xuXHRcdHZhciBmdWxmaWxsZWQgPSB0cnVlO1xuXHRcdGZvciAodmFyIGogPSAwOyBqIDwgY2h1bmtJZHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdGlmICgocHJpb3JpdHkgJiAxID09PSAwIHx8IG5vdEZ1bGZpbGxlZCA+PSBwcmlvcml0eSkgJiYgT2JqZWN0LmtleXMoX193ZWJwYWNrX3JlcXVpcmVfXy5PKS5ldmVyeSgoa2V5KSA9PiAoX193ZWJwYWNrX3JlcXVpcmVfXy5PW2tleV0oY2h1bmtJZHNbal0pKSkpIHtcblx0XHRcdFx0Y2h1bmtJZHMuc3BsaWNlKGotLSwgMSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmdWxmaWxsZWQgPSBmYWxzZTtcblx0XHRcdFx0aWYocHJpb3JpdHkgPCBub3RGdWxmaWxsZWQpIG5vdEZ1bGZpbGxlZCA9IHByaW9yaXR5O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZihmdWxmaWxsZWQpIHtcblx0XHRcdGRlZmVycmVkLnNwbGljZShpLS0sIDEpXG5cdFx0XHRyZXN1bHQgPSBmbigpO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gcmVzdWx0O1xufTsiLCJcInVzZSBzdHJpY3RcIjtcclxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmNvbnN0IHdlYmV4dGVuc2lvbl9wb2x5ZmlsbF90c18xID0gcmVxdWlyZShcIndlYmV4dGVuc2lvbi1wb2x5ZmlsbC10c1wiKTtcclxuY29uc3QgdXRpbGl0aWVzXzEgPSByZXF1aXJlKFwiLi91dGlsaXRpZXNcIik7XHJcbmxldCBjYXRlZ29yeVNldHRpbmdzID0ge307XHJcbmxldCB1cGRhdGVkU2V0dGluZ0hhbmRsZXJzID0ge1xyXG4gICAgXCJub3RpZmljYXRpb25Tb3VuZFVSTFwiOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgbm90aWZpY2F0aW9uU291bmQgPSBuZXcgQXVkaW8oY2F0ZWdvcnlTZXR0aW5nc1tcIm5vdGlmaWNhdGlvblNvdW5kVVJMXCJdLnZhbHVlKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBcIndoaXRlbGlzdGVkS2V5d29yZHNcIjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIHdoaXRlbGlzdGVkS2V5d29yZHMgPSBjYXRlZ29yeVNldHRpbmdzW1wid2hpdGVsaXN0ZWRLZXl3b3Jkc1wiXS52YWx1ZVxyXG4gICAgICAgICAgICAgICAgLnNwbGl0KFwiLFwiKS5tYXAoKGtleXdvcmQpID0+IGtleXdvcmQudHJpbSgpLnRvTG93ZXJDYXNlKCkpXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKChrZXl3b3JkKSA9PiBrZXl3b3JkICE9IFwiXCIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIFwiYmxhY2tsaXN0ZWRLZXl3b3Jkc1wiOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgYmxhY2tsaXN0ZWRLZXl3b3JkcyA9IGNhdGVnb3J5U2V0dGluZ3NbXCJibGFja2xpc3RlZEtleXdvcmRzXCJdLnZhbHVlXHJcbiAgICAgICAgICAgICAgICAuc3BsaXQoXCIsXCIpLm1hcCgoa2V5d29yZCkgPT4ga2V5d29yZC50cmltKCkudG9Mb3dlckNhc2UoKSlcclxuICAgICAgICAgICAgICAgIC5maWx0ZXIoKGtleXdvcmQpID0+IGtleXdvcmQgIT0gXCJcIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn07IC8vIEhhbmRsZXJzIGZvciB3aGVuIHNldHRpbmdzIGFyZSB1cGRhdGVkIHdpdGhvdXQgcmVxdWlyaW5nIHJlbG9hZFxyXG5sZXQgbWVzc2FnZUhhbmRsZXJzID0ge1xyXG4gICAgXCJ1cGRhdGVkU2V0dGluZ1wiOiBmdW5jdGlvbiAoZnVsbFNldHRpbmdzS2V5LCB2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGUgY2F0ZWdvcnkgaXMgY29ycmVjdCwgdXBkYXRlIHNldHRpbmcgdGhlbiBjYWxsIGhhbmRsZXJcclxuICAgICAgICAgICAgY29uc3QgW2NhdGVnb3J5LCBzZXR0aW5nc0tleV0gPSBmdWxsU2V0dGluZ3NLZXkuc3BsaXQoXCItXCIpO1xyXG4gICAgICAgICAgICBpZiAoY2F0ZWdvcnkgPT09IFwiYmVzdGJ1eVwiKSB7XHJcbiAgICAgICAgICAgICAgICBjYXRlZ29yeVNldHRpbmdzW3NldHRpbmdzS2V5XS52YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgeWllbGQgdXBkYXRlZFNldHRpbmdIYW5kbGVyc1tzZXR0aW5nc0tleV0oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIFwidGVzdE5vdGlmaWNhdGlvblNvdW5kXCI6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgeyBub3RpZmljYXRpb25Tb3VuZC5wbGF5KCk7IH0pO1xyXG4gICAgfVxyXG59O1xyXG5sZXQgbm90aWZpY2F0aW9uU291bmQ7XHJcbmxldCB3aGl0ZWxpc3RlZEtleXdvcmRzID0gW107IC8vIExvd2VyY2FzZVxyXG5sZXQgYmxhY2tsaXN0ZWRLZXl3b3JkcyA9IFtdOyAvLyBMb3dlcmNhc2VcclxubGV0IHNhdmVkSXRlbXMgPSBbXTtcclxubGV0IHByZXZpb3VzQ2FydExlbmd0aCA9IDA7IC8vIENhbm5vdCBhY2Nlc3MgRE9NIGdsb2JhbCB2YXJpYWJsZXMsIGltcHJvdmlzZVxyXG5sZXQgbGFzdENsaWNrZWRUaW1lID0gMDsgLy8gVW5peCB0aW1lc3RhbXAgZm9yIGxhc3QgdGltZSBidXR0b24gY2xpY2tlZFxyXG4vLyBDYXJ0IHBhZ2Ugc2F2ZWQgaXRlbXMgcnVudGltZSAtIHBlcmlvZGljYWxseSBwb2xscyBlbGVtZW50cyBmb3IgY29sb3IgYW5kIGNsaWNrYWJpbGl0eVxyXG5mdW5jdGlvbiBzYXZlZENhcnRSdW50aW1lKCkge1xyXG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAvLyBHZXQgaW5pdGlhbCBwcmV2aW91cyBjYXJ0IGxlbmd0aCwgd2FpdCBmb3IgY2FydCB0byBsb2FkXHJcbiAgICAgICAgLy8gRml4ZXMgaXNzdWUgd2l0aCBmYWxzZSBcImFkZCB0byBjYXJ0XCIgbm90aWZpY2F0aW9uIGJlZm9yZSBwYWdlIGxvYWRzXHJcbiAgICAgICAgd2hpbGUgKCQoXCIucGFnZS1oZWFkaW5nX190aXRsZVwiKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgeWllbGQgdXRpbGl0aWVzXzEuc2xlZXAoY2F0ZWdvcnlTZXR0aW5nc1tcImdsb2JhbFBvbGxpbmdJbnRlcnZhbFwiXS52YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGluaXRDYXJ0V3JhcHBlciA9ICQoXCIuaXRlbS1saXN0XCIpWzBdO1xyXG4gICAgICAgIHByZXZpb3VzQ2FydExlbmd0aCA9IGluaXRDYXJ0V3JhcHBlciAhPT0gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgID8gaW5pdENhcnRXcmFwcGVyLmNoaWxkTm9kZXMubGVuZ3RoIDogMDtcclxuICAgICAgICAvLyBLZWVwIGxvb3AgcnVubmluZyB3aGlsZSBwYWdlIGlzIGxvYWRlZFxyXG4gICAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgICAgIC8vIFdhaXQgdW50aWwgc3Bpbm5lciBub3Qgc2hvd2luZyB0byBjb250aW51ZSBpbnRlcnZhbFxyXG4gICAgICAgICAgICB3aGlsZSAoJChcIi5wYWdlLXNwaW5uZXItLWluXCIpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHlpZWxkIHV0aWxpdGllc18xLnNsZWVwKGNhdGVnb3J5U2V0dGluZ3NbXCJnbG9iYWxQb2xsaW5nSW50ZXJ2YWxcIl0udmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIENvbXBhcmUgY3VycmVudCBhbmQgcHJldmlvdXMgY2FydCBjb250ZW50cyBmb3IgY2hhbmdlc1xyXG4gICAgICAgICAgICAvLyBQbGF5IG5vdGlmaWNhdGlvbiBzb3VuZCBpZiBzb21ldGhpbmcgYWRkZWQgdG8gY2FydFxyXG4gICAgICAgICAgICBjb25zdCBjYXJ0V3JhcHBlciA9ICQoXCIuaXRlbS1saXN0XCIpWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50Q2FydExlbmd0aCA9IGNhcnRXcmFwcGVyICE9PSB1bmRlZmluZWRcclxuICAgICAgICAgICAgICAgID8gY2FydFdyYXBwZXIuY2hpbGROb2Rlcy5sZW5ndGggOiAwO1xyXG4gICAgICAgICAgICBpZiAoY3VycmVudENhcnRMZW5ndGggPiBwcmV2aW91c0NhcnRMZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblNvdW5kLnBsYXkoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBJZ25vcmUgcGFyc2luZyBpZiBjYXJ0IGNvbnRhaW5zIGl0ZW0gYW5kIHNldHRpbmcgdG9nZ2xlZFxyXG4gICAgICAgICAgICBwcmV2aW91c0NhcnRMZW5ndGggPSBjdXJyZW50Q2FydExlbmd0aDtcclxuICAgICAgICAgICAgaWYgKGN1cnJlbnRDYXJ0TGVuZ3RoID4gMCAmJiBjYXRlZ29yeVNldHRpbmdzW1wic3RvcENsaWNrQ2FydE9jY3VwaWVkXCJdLnZhbHVlID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICB5aWVsZCB1dGlsaXRpZXNfMS5zbGVlcChjYXRlZ29yeVNldHRpbmdzW1wiZ2xvYmFsUG9sbGluZ0ludGVydmFsXCJdLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIENoZWNrIHdoZXRoZXIgc2F2ZWQgaXRlbSBidXR0b25zIHN0aWxsIGV4aXN0IGluIERPTVxyXG4gICAgICAgICAgICBjb25zdCBzdGlsbEV4aXN0cyA9IHNhdmVkSXRlbXMuc29tZShpdGVtRGF0YSA9PiAkLmNvbnRhaW5zKGRvY3VtZW50LmJvZHksIGl0ZW1EYXRhLndyYXBwZXIpKTtcclxuICAgICAgICAgICAgaWYgKHN0aWxsRXhpc3RzID09PSBmYWxzZSkgeyAvLyBTYXZlZCBpdGVtcyBwcm9iYWJseSByZWxvYWQsIHJlLXNjcmFwZVxyXG4gICAgICAgICAgICAgICAgbGV0IHNhdmVkRWxlbWVudHMgPSAkKFwiLnNhdmVkLWl0ZW1zX19jYXJkLXdyYXBwZXJcIikudG9BcnJheSgpO1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKHNhdmVkRWxlbWVudHMubGVuZ3RoID09PSAwKSB7IC8vIFdhaXQgdW50aWwgc2F2ZWQgaXRlbXMgZWxlbWVudHMgZXhpc3RcclxuICAgICAgICAgICAgICAgICAgICB5aWVsZCB1dGlsaXRpZXNfMS5zbGVlcChjYXRlZ29yeVNldHRpbmdzW1wiZ2xvYmFsUG9sbGluZ0ludGVydmFsXCJdLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICBzYXZlZEVsZW1lbnRzID0gJChcIi5zYXZlZC1pdGVtc19fY2FyZC13cmFwcGVyXCIpLnRvQXJyYXkoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIERpc2d1c3Rpbmcgd2F5IHRvIG1hcCBlbGVtZW50cywgY2FuJ3QgYXJyb3cgbWFwIHRvIGludGVyZmFjZSBhcHBhcmVudGx5XHJcbiAgICAgICAgICAgICAgICBzYXZlZEl0ZW1zID0gc2F2ZWRFbGVtZW50cy5tYXAoZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3cmFwcGVyOiBlbGVtZW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBza3U6IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS10ZXN0LXNhdmVkLXNrdVwiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICQoZWxlbWVudCkuZmluZChcIi5zaW1wbGUtaXRlbV9fZGVzY3JpcHRpb25cIilbMF0uaW5uZXJUZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRCdXR0b246ICQoZWxlbWVudCkuZmluZChcIi5idG5cIilbMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIFJlLXNjcmFwZSBzYXZlZCBpdGVtcyBlbGVtZW50cyBvbmx5IHdoZW4gdW5sb2FkZWQgZnJvbSBET00sIGJ1dCByZS1maWx0ZXIgZXZlcnkgaW50ZXJ2YWxcclxuICAgICAgICAgICAgY29uc3QgZmlsdGVyZWRTYXZlZEl0ZW1zID0gc2F2ZWRJdGVtcy5maWx0ZXIoc2F2ZWRJdGVtID0+IHdoaXRlbGlzdGVkS2V5d29yZHMuc29tZSgvLyBDb250YWlucyBhdCBsZWFzdCBvbmUgd2hpdGVsaXN0ZWQga2V5d29yZFxyXG4gICAgICAgICAgICAvLyBDb250YWlucyBhdCBsZWFzdCBvbmUgd2hpdGVsaXN0ZWQga2V5d29yZFxyXG4gICAgICAgICAgICBrZXl3b3JkID0+IGtleXdvcmQgIT09IFwiXCIgJiYgc2F2ZWRJdGVtLmRlc2NyaXB0aW9uLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoa2V5d29yZCkpKS5maWx0ZXIoLy8gQ29udGFpbnMgbm8gd2hpdGVsaXN0ZWQga2V5d29yZHMsIGVkZ2UgY2FzZSBmb3IgZW1wdHkgYmxhY2tsaXN0ZWQga2V5d29yZHNcclxuICAgICAgICAgICAgLy8gQ29udGFpbnMgbm8gd2hpdGVsaXN0ZWQga2V5d29yZHMsIGVkZ2UgY2FzZSBmb3IgZW1wdHkgYmxhY2tsaXN0ZWQga2V5d29yZHNcclxuICAgICAgICAgICAgc2F2ZWRJdGVtID0+IGJsYWNrbGlzdGVkS2V5d29yZHMuZXZlcnkoa2V5d29yZCA9PiAhc2F2ZWRJdGVtLmRlc2NyaXB0aW9uLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoa2V5d29yZCkpKTtcclxuICAgICAgICAgICAgLy8gU2F2ZWQgaXRlbXMgc3RpbGwgbG9hZGVkIG9yIHJlLXNjcmFwZWQsIGl0ZXJhdGUgb3ZlclxyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHNhdmVkSXRlbSBvZiBmaWx0ZXJlZFNhdmVkSXRlbXMpIHtcclxuICAgICAgICAgICAgICAgIC8vIENoZWNrIHdoZXRoZXIgYnV0dG9uIGNvbG9yIGlzIGNsaWNrYWJsZSAobm90IGdyZXkpXHJcbiAgICAgICAgICAgICAgICBjb25zdCBidXR0b25Db2xvciA9IHV0aWxpdGllc18xLmVsZW1lbnRDb2xvcihzYXZlZEl0ZW0uYWRkQnV0dG9uKTtcclxuICAgICAgICAgICAgICAgIGlmIChbXCJ3aGl0ZVwiLCBcImJsdWVcIiwgXCJ5ZWxsb3dcIl0uaW5jbHVkZXMoYnV0dG9uQ29sb3IpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2xpY2sgaWYgYXV0by1jbGljayBpcyBlbmFibGVkIGluIHNldHRpbmdzIGFuZCB0aW1lb3V0IGVsYXBzZWRcclxuICAgICAgICAgICAgICAgICAgICAvLyBHaXZpbmcgdGltZW91dCBiZXR3ZWVuIGJ1dHRvbiBjbGlja3MgcHJldmVudHMgcmF0ZS1saW1pdHMgYW5kIHN1Y2hcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzaW5jZUxhc3RDbGljayA9IE51bWJlcihuZXcgRGF0ZSgpKSAtIGxhc3RDbGlja2VkVGltZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2F0ZWdvcnlTZXR0aW5nc1tcImF1dG9DbGlja1doaXRlbGlzdGVkXCJdLnZhbHVlID09PSB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIHNpbmNlTGFzdENsaWNrID4gY2F0ZWdvcnlTZXR0aW5nc1tcInN1Y2Nlc3NpdmVDbGlja1RpbWVvdXRcIl0udmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZWRJdGVtLmFkZEJ1dHRvbi5jbGljaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0Q2xpY2tlZFRpbWUgPSBOdW1iZXIobmV3IERhdGUoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHlpZWxkIHV0aWxpdGllc18xLnNsZWVwKGNhdGVnb3J5U2V0dGluZ3NbXCJnbG9iYWxQb2xsaW5nSW50ZXJ2YWxcIl0udmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbi8vIEFzeW5jaHJvbm91cyBtYWluIGNvbnRlbnQgc2NyaXB0IHJ1bnRpbWVcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgLy8gUmV0cmlldmUgdXBkYXRlZCBzZXR0aW5ncyBmcm9tIFN0b3JhZ2UgQVBJIGFuZCBpbml0aWFsaXplXHJcbiAgICAgICAgY2F0ZWdvcnlTZXR0aW5ncyA9IHlpZWxkIHV0aWxpdGllc18xLnJldHJpZXZlU2V0dGluZ3NLVihcImJlc3RidXlcIik7XHJcbiAgICAgICAgZm9yIChjb25zdCBbXywgdXBkYXRlZFNldHRpbmdIYW5kbGVyXSBvZiBPYmplY3QuZW50cmllcyh1cGRhdGVkU2V0dGluZ0hhbmRsZXJzKSkge1xyXG4gICAgICAgICAgICB5aWVsZCB1cGRhdGVkU2V0dGluZ0hhbmRsZXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gU2V0dXAgbWVzc2FnZSBsaXN0ZW5lciBtYWlubHkgZm9yIHVwZGF0ZWQgc2V0dGluZ3NcclxuICAgICAgICB3ZWJleHRlbnNpb25fcG9seWZpbGxfdHNfMS5icm93c2VyLnJ1bnRpbWUub25NZXNzYWdlLmFkZExpc3RlbmVyKGZ1bmN0aW9uIChtZXNzYWdlLCBzZW5kZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgICAgIC8vIFByb2Nlc3MgaGFuZGxlciB3aXRoIHByb3ZpZGVkIGFyZ3VtZW50cyBhbmQgcmVzcG9uZCBpZiBuZWNlc3NhcnlcclxuICAgICAgICAgICAgICAgIGNvbnN0IGhhbmRsZXIgPSBtZXNzYWdlSGFuZGxlcnNbbWVzc2FnZS5pbnN0cnVjdGlvbl07XHJcbiAgICAgICAgICAgICAgICBpZiAoaGFuZGxlciAhPT0gdW5kZWZpbmVkKSB7IC8vIENoZWNrIHdoZXRoZXIgZ2l2ZW4gaGFuZGxlciBleGlzdHNcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB5aWVsZCBoYW5kbGVyKC4uLm1lc3NhZ2UuYXJndW1lbnRzIHx8IFtdKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0OyAvLyBFcXVpdmFsZW50IHRvIHNlbmRSZXNwb25zZT9cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gU3RvcmUgY3VycmVudCBxdWV1ZSBkYXRhIGFsb25nIHdpdGggdGltZXN0YW1wXHJcbiAgICAgICAgY29uc3QgcXVldWVJbmZvID0ge1xyXG4gICAgICAgICAgICBkYXRhOiBhdG9iKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwicHVyY2hhc2VUcmFja2VyXCIpIHx8IFwiZTMwPVwiKSxcclxuICAgICAgICAgICAgdGltZTogTnVtYmVyKG5ldyBEYXRlKCkpLFxyXG4gICAgICAgIH07IC8vIFwiTGFzdCB1cGRhdGVkXCIgdGltZXN0YW1wIGZvciBleHRlbnNpb25cclxuICAgICAgICB5aWVsZCB3ZWJleHRlbnNpb25fcG9seWZpbGxfdHNfMS5icm93c2VyLnN0b3JhZ2UubG9jYWwuc2V0KHsgXCJiZXN0YnV5LXF1ZXVlSW5mb1wiOiBxdWV1ZUluZm8gfSk7XHJcbiAgICAgICAgd2ViZXh0ZW5zaW9uX3BvbHlmaWxsX3RzXzEuYnJvd3Nlci5ydW50aW1lLnNlbmRNZXNzYWdlKHsgXCJpbnN0cnVjdGlvblwiOiBcInVwZGF0ZWRRdWV1ZUluZm9cIiwgXCJhcmd1bWVudHNcIjogW3F1ZXVlSW5mb10gfSk7XHJcbiAgICAgICAgeWllbGQgc2F2ZWRDYXJ0UnVudGltZSgpOyAvLyBBY3R1YWwgcnVudGltZSBmb3IgY2FydCBzdHVmZiwgcGVycGV0dWFsP1xyXG4gICAgfSk7XHJcbn0oKSk7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuZGVmYXVsdFNldHRpbmdzID0gZXhwb3J0cy5jaGFuZ2Vsb2dzID0gdm9pZCAwO1xyXG4vLyBDaGFuZ2Vsb2cgZnJvbSBwcmV2aW91cyB2ZXJzaW9uc1xyXG5leHBvcnRzLmNoYW5nZWxvZ3MgPSBbXHJcbiAgICB7XHJcbiAgICAgICAgXCJ2ZXJzaW9uXCI6IFwiYjAuMi4xXCIsXHJcbiAgICAgICAgXCJidWxsZXRwb2ludHNcIjogW1xyXG4gICAgICAgICAgICBgRml4ZWQgZW1wdHkgYmxhY2tsaXN0IGRpc3F1YWxpZnlpbmcgYWxsIHNhdmVkIGl0ZW1zYCxcclxuICAgICAgICAgICAgYFJlcGxhY2VkIGljb24gd2hpY2ggc2FpZCBcIkFRVVwiIGluc3RlYWQgb2YgXCJBR1VcIiAob3JpZ2luYWwgZXh0ZW5zaW9uIG5hbWUgd2FzIEF1dG9RdWV1ZVV0aWxpdGllcylgLFxyXG4gICAgICAgICAgICBgPGI+VE9ETzo8L2I+IEZpeCBub3RpZmljYXRpb24gc291bmQgbm90IHBsYXlpbmcgaWYgdXNlciBoYXNuJ3QgaW50ZXJhY3RlZCB3aXRoIGRvY3VtZW50LCBtYXliZSBwbGF5IGZyb20gYmFja2dyb3VuZCBpbnN0ZWFkP2BcclxuICAgICAgICBdXHJcbiAgICB9LCB7XHJcbiAgICAgICAgXCJ2ZXJzaW9uXCI6IFwiYjAuMi4wXCIsXHJcbiAgICAgICAgXCJidWxsZXRwb2ludHNcIjogW1xyXG4gICAgICAgICAgICBgQWRkZWQgQWJvdXQgdGFiIHNob3dpbmcgc29tZSBpbmZvcm1hdGlvbiBhbmQgdXNhZ2UgaW5zdHJ1Y3Rpb25zYCxcclxuICAgICAgICAgICAgYENoYW5nZWQgZXh0ZW5zaW9uIGljb24gdG8gc29tZXRoaW5nIHNvbWV3aGF0IG1vcmUgcHJlc2VudGFibGVgLFxyXG4gICAgICAgICAgICBgUmVtb3ZlZCBwbGFjZWhvbGRlciBsb2dnaW5nIHRhYiBwZW5kaW5nIGZ1cnRoZXIgZGV2ZWxvcG1lbnRgLFxyXG4gICAgICAgICAgICBgQWRkZWQgYmxhY2tsaXN0ZWQga2V5d29yZHMgZnVuY3Rpb25hbGl0eSB0byBzY3JpcHQgKHN0aWxsIG5vIHRlc3QgYnV0dG9ucylgLFxyXG4gICAgICAgICAgICBgT3RoZXIgbWlub3IgZWRpdHMgdG8gZXh0ZW5zaW9uIHBvcHVwIHN0eWxpbmcsIG5vdGhpbmcgdG9vIG1ham9yYCxcclxuICAgICAgICBdXHJcbiAgICB9LCB7XHJcbiAgICAgICAgXCJ2ZXJzaW9uXCI6IFwiYjAuMS4wXCIsXHJcbiAgICAgICAgXCJidWxsZXRwb2ludHNcIjogW1xyXG4gICAgICAgICAgICBgQWRkZWQgY2hhbmdlbG9nICh0aGlzIHRhYiBoZXJlKSBhbmQgcGxhY2Vob2xkZXIgbG9nZ2luZyB0YWIgZm9yIHRlc3RpbmdgLFxyXG4gICAgICAgICAgICBgQ2hhbmdlZCBleHRlbnNpb24gc2NyaXB0IGxvYWRpbmcgdG8gd29yayBzb21ld2hhdCBtb3JlIGR5bmFtaWNhbGx5YCxcclxuICAgICAgICBdXHJcbiAgICB9LCB7XHJcbiAgICAgICAgXCJ2ZXJzaW9uXCI6IFwiYjAuMC4xXCIsXHJcbiAgICAgICAgXCJidWxsZXRwb2ludHNcIjogW1xyXG4gICAgICAgICAgICBgUG9ydGVkIG1vc3QgZnVuY3Rpb25hbGl0eSBmcm9tIFRhbXBlcm1vbmtleSBzY3JpcHQgbG9jYXRlZCA8YSBocmVmPVwiaHR0cHM6Ly9naXRodWIuY29tL2FsYmVydC1zdW4vdGFtcGVyLXNjcmlwdHMvXCI+aGVyZTwvYT5gLFxyXG4gICAgICAgICAgICBgPGI+RmVhdHVyZXMgbm90IHlldCBpbXBsZW1lbnRlZDwvYj46IGJsYWNrbGlzdGVkIGtleXdvcmRzIGFuZCBidXR0b25zIGZvciB0ZXN0aW5nIHd0aWhpbiBzZXR0aW5ncyAocmVtb3ZlZCB1bnRpbCBzZXR0aW5ncyBzdHJ1Y3R1cmUgZmluYWxpemVkKWAsXHJcbiAgICAgICAgICAgIGA8Yj5JbXByb3ZlbWVudHMgZnJvbSBUYW1wZXJtb25rZXkgc2NyaXB0PC9iPjogSW5zdGFudCBzZXR0aW5ncyBwcm9wb2dhdGlvbiBhbmQgbm8gcmVmcmVzaCByZXF1aXJlZCBmb3IgY2FydCBhZGRpdGlvbiBvciByZW1vdmFsYFxyXG4gICAgICAgIF1cclxuICAgIH1cclxuXTtcclxuLy8gU2V0dGluZ3MgYWNyb3NzIGFsbCBjYXRlZ29yaWVzIGZvciBleHRlbnNpb25cclxuZXhwb3J0cy5kZWZhdWx0U2V0dGluZ3MgPSB7XHJcbiAgICBcImJlc3RidXlcIjogW1xyXG4gICAgICAgIHsga2V5OiBcImF1dG9tYXRpY1F1ZXVlRml4XCIsIGRlc2NyaXB0aW9uOiBcIkF0dGVtcHQgdG8gYXV0b21hdGljYWxseSBmaXggYnJva2VuIHF1ZXVlc1wiLCB0eXBlOiBcInNsaWRlU3dpdGNoXCIsIHZhbHVlOiB0cnVlIH0sXHJcbiAgICAgICAgeyBrZXk6IFwiYXV0b0NsaWNrV2hpdGVsaXN0ZWRcIiwgZGVzY3JpcHRpb246IFwiQXV0b21hdGljYWxseSBjbGljayB3aGl0ZWxpc3RlZCBBVEMgYnV0dG9uc1wiLCB0eXBlOiBcInNsaWRlU3dpdGNoXCIsIHZhbHVlOiB0cnVlIH0sXHJcbiAgICAgICAgeyBrZXk6IFwic3RvcENsaWNrQ2FydE9jY3VwaWVkXCIsIGRlc2NyaXB0aW9uOiBcIlN0b3AgYXV0b21hdGljIGNsaWNraW5nIHdoZW4gY2FydCBvY2N1cGllZFwiLCB0eXBlOiBcInNsaWRlU3dpdGNoXCIsIHZhbHVlOiB0cnVlIH0sXHJcbiAgICAgICAgeyBrZXk6IFwiZ2xvYmFsUG9sbGluZ0ludGVydmFsXCIsIGRlc2NyaXB0aW9uOiBcIkdsb2JhbCBjb250ZW50IHNjcmlwdCBwb2xsaW5nIGludGVydmFsXCIsIHR5cGU6IFwibnVtYmVyXCIsIGV4dHJhVGV4dDogXCJtc1wiLCB2YWx1ZTogMTAwIH0sXHJcbiAgICAgICAgeyBrZXk6IFwic3VjY2Vzc2l2ZUNsaWNrVGltZW91dFwiLCBkZXNjcmlwdGlvbjogXCJUaW1lb3V0IGJldHdlZW4gY2xpY2tpbmcgdW5pcXVlIGJ1dHRvbnNcIiwgdHlwZTogXCJudW1iZXJcIiwgZXh0cmFUZXh0OiBcIm1zXCIsIHZhbHVlOiAyNTAwIH0sXHJcbiAgICAgICAgeyBrZXk6IFwibm90aWZpY2F0aW9uU291bmRVUkxcIiwgZGVzY3JpcHRpb246IFwiTm90aWZpY2F0aW9uIHNvdW5kIFVSTCAobXAzIGhvdGxpbmspXCIsIHR5cGU6IFwidGV4dFwiLCB2YWx1ZTogXCJodHRwczovL2dpdGh1Yi5jb20vYWxiZXJ0LXN1bi90YW1wZXItc2NyaXB0cy9ibG9iL21haW4vcmVzb3VyY2VzL25vdGlmaWNhdGlvbi5tcDM/cmF3PXRydWVcIiB9LFxyXG4gICAgICAgIHsga2V5OiBcIndoaXRlbGlzdGVkS2V5d29yZHNcIiwgZGVzY3JpcHRpb246IFwiV2hpdGVsaXN0ZWQga2V5d29yZHMgKGNvbW1hLXNlcGFyYXRlZClcIiwgdHlwZTogXCJ0ZXh0XCIsIHZhbHVlOiBcIjMwNjAsMzA2MHRpLDMwNjAgdGksMzA3MCwzMDcwdGksMzA3MCB0aSwzMDgwLDMwODB0aSwzMDgwIHRpLDMwOTBcIiB9LFxyXG4gICAgICAgIHsga2V5OiBcImJsYWNrbGlzdGVkS2V5d29yZHNcIiwgZGVzY3JpcHRpb246IFwiQmxhY2tsaXN0ZWQga2V5d29yZHMgKGNvbW1hLXNlcGFyYXRlZClcIiwgdHlwZTogXCJ0ZXh0XCIsIHZhbHVlOiBcIlwiIH0sXHJcbiAgICAgICAgLy8geyBrZXk6IFwidGVzdE5vdGlmaWNhdGlvblNvdW5kXCIsIGRlc2NyaXB0aW9uOiBcIlBsYXkgY3VycmVudCBub3RpZmljYXRpb24gc291bmRcIiwgdHlwZTogXCJidXR0b25cIiwgaW5zdHJ1Y3Rpb246IFwidGVzdE5vdGlmaWNhdGlvblNvdW5kXCIgfSxcclxuICAgIF1cclxufTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLnJldHJpZXZlU2V0dGluZ3NLViA9IGV4cG9ydHMucmV0cmlldmVTZXR0aW5ncyA9IGV4cG9ydHMuc3RvcmFnZUdldCA9IGV4cG9ydHMuZWxlbWVudENvbG9yID0gZXhwb3J0cy5zbGVlcCA9IHZvaWQgMDtcclxuY29uc3Qgd2ViZXh0ZW5zaW9uX3BvbHlmaWxsX3RzXzEgPSByZXF1aXJlKFwid2ViZXh0ZW5zaW9uLXBvbHlmaWxsLXRzXCIpO1xyXG5jb25zdCBjb25zdGFudHNfMSA9IHJlcXVpcmUoXCIuL2NvbnN0YW50c1wiKTtcclxuLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvOTUxMDIxL3doYXQtaXMtdGhlLWphdmFzY3JpcHQtdmVyc2lvbi1vZi1zbGVlcFxyXG4vLyBQb3NzaWJseSBoYXMgaXNzdWVzIHJlc29sdmluZyBvbiBGaXJlZm94PyBTdGFja092ZXJmbG93IHN1cmUgZG9lc24ndCB0aGluayBzby4uLlxyXG5mdW5jdGlvbiBzbGVlcChtcykge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xyXG59XHJcbmV4cG9ydHMuc2xlZXAgPSBzbGVlcDtcclxuLy8gQXBwcm94aW1hdGVzIHRoZSByZW5kZXJlZCBiYWNrZ3JvdW5kIGNvbG9yIG9mIGEgZ2l2ZW4gZWxlbWVudCB0byBhIGdpdmVuIHNldCBvZiBjb2xvcnMuXHJcbi8vIENoZWNrcyB3aGV0aGVyIHRoZSBcImRpc3RhbmNlXCIgZnJvbSB0aGUgZWxlbWVudCBjb2xvciBpcyB0cmFuc3BhcmVudCBvciBjbG9zZXN0IHRvIGVpdGhlciB5ZWxsb3cvd2hpdGUvYmx1ZS5cclxuY29uc3QgY29sb3JzID0gW1xyXG4gICAgeyBjb2xvcjogXCJ5ZWxsb3dcIiwgcjogMjU1LCBnOiAyMjQsIGI6IDAgfSxcclxuICAgIHsgY29sb3I6IFwiYmx1ZVwiLCByOiAwLCBnOiAzMCwgYjogMTE1IH0sXHJcbiAgICB7IGNvbG9yOiBcImdyZXlcIiwgcjogMTk3LCBnOiAyMDMsIGI6IDIxMyB9LFxyXG4gICAgeyBjb2xvcjogXCJ3aGl0ZVwiLCByOiAyNTUsIGc6IDI1NSwgYjogMjU1IH0sXHJcbl07XHJcbmZ1bmN0aW9uIGVsZW1lbnRDb2xvcihlbGVtZW50KSB7XHJcbiAgICAvLyBHZXQgdGhlIHJlbmRlcmVkIGJhY2tncm91bmQgY29sb3Igb2YgdGhlIGVsZW1lbnRcclxuICAgIGNvbnN0IGNvbG9yVGV4dCA9IGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCwgbnVsbCkuZ2V0UHJvcGVydHlWYWx1ZShcImJhY2tncm91bmQtY29sb3JcIik7XHJcbiAgICBpZiAoY29sb3JUZXh0LmluY2x1ZGVzKFwicmdiKDAsIDAsIDBcIikpIHsgLy8gZWxlbWVudCBoYXMgbm8gY29sb3IgPSB0cmFuc3BhcmVudFxyXG4gICAgICAgIHJldHVybiBcInRyYW5zcGFyZW50XCI7XHJcbiAgICB9XHJcbiAgICAvLyBQYXJzZSBSR0IgdmFsdWUgYW5kIHVzZSBmYW5jeSBtYXRocyB0byBmaW5kIGNsb3Nlc3QgY29sb3JcclxuICAgIGNvbnN0IHBhcnNlZENvbG9yID0geyByOiAwLCBnOiAwLCBiOiAwIH07XHJcbiAgICBjb25zdCBtYXRjaGVkQ29sb3IgPSBjb2xvclRleHQubWF0Y2goL15yZ2JcXHMqXFwoXFxzKihcXGQrKVxccyosXFxzKihcXGQrKVxccyosXFxzKihcXGQrKVxccypcXCkkL2kpO1xyXG4gICAgcGFyc2VkQ29sb3IuciA9IE51bWJlcihtYXRjaGVkQ29sb3JbMV0pO1xyXG4gICAgcGFyc2VkQ29sb3IuZyA9IE51bWJlcihtYXRjaGVkQ29sb3JbMl0pO1xyXG4gICAgcGFyc2VkQ29sb3IuYiA9IE51bWJlcihtYXRjaGVkQ29sb3JbM10pO1xyXG4gICAgY29uc3QgY2xvc2VzdCA9IHsgY29sb3I6IFwiXCIsIGRpc3RhbmNlOiA0NDIgfTsgLy8gRGVmYXVsdCBkaXN0YW5jZSBqdXN0IHNsaWdodGx5IGxhcmdlciB0aGFuIG1heFxyXG4gICAgZm9yIChjb25zdCBjaGVja0NvbG9yIG9mIGNvbG9ycykge1xyXG4gICAgICAgIGNvbnN0IGRpc3RhbmNlID0gTWF0aC5zcXJ0KE1hdGgucG93KChwYXJzZWRDb2xvci5yIC0gY2hlY2tDb2xvci5yKSwgMikgKyBNYXRoLnBvdygocGFyc2VkQ29sb3IuZyAtIGNoZWNrQ29sb3IuZyksIDIpICsgKHBhcnNlZENvbG9yLmIgLSBjaGVja0NvbG9yLmIpKTtcclxuICAgICAgICBpZiAoZGlzdGFuY2UgPCBjbG9zZXN0LmRpc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIGNsb3Nlc3QuY29sb3IgPSBjaGVja0NvbG9yLmNvbG9yO1xyXG4gICAgICAgICAgICBjbG9zZXN0LmRpc3RhbmNlID0gZGlzdGFuY2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNsb3Nlc3QuY29sb3I7XHJcbn1cclxuZXhwb3J0cy5lbGVtZW50Q29sb3IgPSBlbGVtZW50Q29sb3I7XHJcbi8vIFdyYXBwZXIgZm9yIHJldHJpZXZpbmcgZnJvbSBzdG9yYWdlIHdpdGggZGVmYXVsdCB2YWx1ZSBpZiB1bmRlZmluZWRcclxuZnVuY3Rpb24gc3RvcmFnZUdldChzdG9yYWdlS2V5LCBkZWZhdWx0VmFsdWUpIHtcclxuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uc3Qgc3RvcmFnZVJlc3VsdCA9IHlpZWxkIHdlYmV4dGVuc2lvbl9wb2x5ZmlsbF90c18xLmJyb3dzZXIuc3RvcmFnZS5sb2NhbC5nZXQoc3RvcmFnZUtleSk7XHJcbiAgICAgICAgcmV0dXJuIHN0b3JhZ2VSZXN1bHRbc3RvcmFnZUtleV0gIT09IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICA/IHN0b3JhZ2VSZXN1bHRbc3RvcmFnZUtleV0gOiBkZWZhdWx0VmFsdWU7XHJcbiAgICB9KTtcclxufVxyXG5leHBvcnRzLnN0b3JhZ2VHZXQgPSBzdG9yYWdlR2V0O1xyXG4vLyBXcmFwcGVyIGZvciByZXRyaWV2aW5nIHNldHRpbmdzIGZvciBnaXZlbiBjYXRlZ29yeSBieSB1cGRhdGluZyBmcm9tIFN0b3JhZ2UgQVBJXHJcbmZ1bmN0aW9uIHJldHJpZXZlU2V0dGluZ3Moc2V0dGluZ3NDYXRlZ29yeSkge1xyXG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAvLyBHZXQgZGVmYXVsdCBzZXR0aW5ncywgdGhlbiB1cGRhdGUgaW5kaXZpZHVhbCBzZXR0aW5ncyBmcm9tIFN0b3JhZ2UgQVBJXHJcbiAgICAgICAgY29uc3QgY2F0ZWdvcnlTZXR0aW5ncyA9IGNvbnN0YW50c18xLmRlZmF1bHRTZXR0aW5nc1tzZXR0aW5nc0NhdGVnb3J5XTtcclxuICAgICAgICBmb3IgKGNvbnN0IHNldHRpbmcgb2YgY2F0ZWdvcnlTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAvLyBJZ25vcmUgc2V0dGluZ3Mgd2l0aG91dCBhIHZhbHVlIChidXR0b25zIG1haW5seSlcclxuICAgICAgICAgICAgaWYgKHNldHRpbmcudmFsdWUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gUmVwbGFjZSB3aXRoIHZhbHVlIGZyb20gc3RvcmFnZSBpZiBtb2RpZmllZCBleGlzdHMsIG90aGVyd2lzZSBrZWVwIGRlZmF1bHRcclxuICAgICAgICAgICAgY29uc3Qgc2V0dGluZ0tleSA9IGBzZXR0aW5nLSR7c2V0dGluZ3NDYXRlZ29yeX0tJHtzZXR0aW5nLmtleX1gO1xyXG4gICAgICAgICAgICBzZXR0aW5nLnZhbHVlID0geWllbGQgc3RvcmFnZUdldChzZXR0aW5nS2V5LCBzZXR0aW5nLnZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNhdGVnb3J5U2V0dGluZ3M7XHJcbiAgICB9KTtcclxufVxyXG5leHBvcnRzLnJldHJpZXZlU2V0dGluZ3MgPSByZXRyaWV2ZVNldHRpbmdzO1xyXG4vLyBXcmFwcGVyIGZvciBmb3JtYXR0aW5nIHRoZSBzZXR0aW5ncyBpbnRvIGtleS12YWx1ZSBpbnN0ZWFkIG9mIGFycmF5XHJcbmZ1bmN0aW9uIHJldHJpZXZlU2V0dGluZ3NLVihzZXR0aW5nc0NhdGVnb3J5KSB7XHJcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3J5U2V0dGluZ3NLViA9IHt9O1xyXG4gICAgICAgIGNvbnN0IGNhdGVnb3J5U2V0dGluZ3MgPSB5aWVsZCByZXRyaWV2ZVNldHRpbmdzKHNldHRpbmdzQ2F0ZWdvcnkpOyAvLyBHZXQgc2V0dGluZ3MgYmVmb3JlIHJlZm9ybWF0dGluZ1xyXG4gICAgICAgIGZvciAoY29uc3Qgc2V0dGluZyBvZiBjYXRlZ29yeVNldHRpbmdzKSB7XHJcbiAgICAgICAgICAgIC8vIElnbm9yZSBzZXR0aW5ncyB3aXRob3V0IGEgdmFsdWUgKGJ1dHRvbnMgbWFpbmx5KVxyXG4gICAgICAgICAgICBpZiAoc2V0dGluZy52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRlZ29yeVNldHRpbmdzS1Zbc2V0dGluZy5rZXldID0gc2V0dGluZztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNhdGVnb3J5U2V0dGluZ3NLVjtcclxuICAgIH0pO1xyXG59XHJcbmV4cG9ydHMucmV0cmlldmVTZXR0aW5nc0tWID0gcmV0cmlldmVTZXR0aW5nc0tWO1xyXG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbl9fd2VicGFja19yZXF1aXJlX18ubSA9IF9fd2VicGFja19tb2R1bGVzX187XG5cbiIsIi8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSAobW9kdWxlKSA9PiB7XG5cdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuXHRcdCgpID0+IChtb2R1bGVbJ2RlZmF1bHQnXSkgOlxuXHRcdCgpID0+IChtb2R1bGUpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCB7IGE6IGdldHRlciB9KTtcblx0cmV0dXJuIGdldHRlcjtcbn07IiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5qID0gODQzOyIsIi8vIG5vIGJhc2VVUklcblxuLy8gb2JqZWN0IHRvIHN0b3JlIGxvYWRlZCBhbmQgbG9hZGluZyBjaHVua3Ncbi8vIHVuZGVmaW5lZCA9IGNodW5rIG5vdCBsb2FkZWQsIG51bGwgPSBjaHVuayBwcmVsb2FkZWQvcHJlZmV0Y2hlZFxuLy8gW3Jlc29sdmUsIHJlamVjdCwgUHJvbWlzZV0gPSBjaHVuayBsb2FkaW5nLCAwID0gY2h1bmsgbG9hZGVkXG52YXIgaW5zdGFsbGVkQ2h1bmtzID0ge1xuXHQ4NDM6IDAsXG5cdDUzMzogMCxcblx0Mzg2OiAwXG59O1xuXG4vLyBubyBjaHVuayBvbiBkZW1hbmQgbG9hZGluZ1xuXG4vLyBubyBwcmVmZXRjaGluZ1xuXG4vLyBubyBwcmVsb2FkZWRcblxuLy8gbm8gSE1SXG5cbi8vIG5vIEhNUiBtYW5pZmVzdFxuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLk8uaiA9IChjaHVua0lkKSA9PiAoaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID09PSAwKTtcblxuLy8gaW5zdGFsbCBhIEpTT05QIGNhbGxiYWNrIGZvciBjaHVuayBsb2FkaW5nXG52YXIgd2VicGFja0pzb25wQ2FsbGJhY2sgPSAocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24sIGRhdGEpID0+IHtcblx0dmFyIFtjaHVua0lkcywgbW9yZU1vZHVsZXMsIHJ1bnRpbWVdID0gZGF0YTtcblx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG5cdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuXHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwO1xuXHRmb3IobW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8obW9yZU1vZHVsZXMsIG1vZHVsZUlkKSkge1xuXHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcblx0XHR9XG5cdH1cblx0aWYocnVudGltZSkgdmFyIHJlc3VsdCA9IHJ1bnRpbWUoX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cdGlmKHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uKSBwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbihkYXRhKTtcblx0Zm9yKDtpIDwgY2h1bmtJZHMubGVuZ3RoOyBpKyspIHtcblx0XHRjaHVua0lkID0gY2h1bmtJZHNbaV07XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkgJiYgaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdKSB7XG5cdFx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1bMF0oKTtcblx0XHR9XG5cdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRzW2ldXSA9IDA7XG5cdH1cblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18uTyhyZXN1bHQpO1xufVxuXG52YXIgY2h1bmtMb2FkaW5nR2xvYmFsID0gc2VsZltcIndlYnBhY2tDaHVua2V4dGVuc2lvblwiXSA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmtleHRlbnNpb25cIl0gfHwgW107XG5jaHVua0xvYWRpbmdHbG9iYWwuZm9yRWFjaCh3ZWJwYWNrSnNvbnBDYWxsYmFjay5iaW5kKG51bGwsIDApKTtcbmNodW5rTG9hZGluZ0dsb2JhbC5wdXNoID0gd2VicGFja0pzb25wQ2FsbGJhY2suYmluZChudWxsLCBjaHVua0xvYWRpbmdHbG9iYWwucHVzaC5iaW5kKGNodW5rTG9hZGluZ0dsb2JhbCkpOyIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgZGVwZW5kcyBvbiBvdGhlciBsb2FkZWQgY2h1bmtzIGFuZCBleGVjdXRpb24gbmVlZCB0byBiZSBkZWxheWVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18uTyh1bmRlZmluZWQsIFs3MzZdLCAoKSA9PiAoX193ZWJwYWNrX3JlcXVpcmVfXyg5NzA1KSkpXG5fX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXy5PKF9fd2VicGFja19leHBvcnRzX18pO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==