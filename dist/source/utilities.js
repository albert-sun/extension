(()=>{"use strict";var e,t={8681:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSettings=t.changelogs=void 0,t.changelogs=[{version:"b0.2.0",bulletpoints:["Added About tab showing some information and usage instructions","Changed extension icon to something somewhat more presentable","Removed placeholder logging tab pending further development","Added blacklisted keywords functionality to script (still no test buttons)","Other minor edits to extension popup styling, nothing too major"]},{version:"b0.1.0",bulletpoints:["Added changelog (this tab here) and placeholder logging tab for testing","Changed extension script loading to work somewhat more dynamically"]},{version:"b0.0.1",bulletpoints:['Ported most functionality from Tampermonkey script located <a href="https://github.com/albert-sun/tamper-scripts/">here</a>',"<b>Features not yet implemented</b>: blacklisted keywords and buttons for testing wtihin settings (removed until settings structure finalized)","<b>Improvements from Tampermonkey script</b>: Instant settings propogation and no refresh required for cart addition or removal"]}],t.defaultSettings={bestbuy:[{key:"automaticQueueFix",description:"Attempt to automatically fix broken queues",type:"slideSwitch",value:!0},{key:"autoClickWhitelisted",description:"Automatically click whitelisted ATC buttons",type:"slideSwitch",value:!0},{key:"stopClickCartOccupied",description:"Stop automatic clicking when cart occupied",type:"slideSwitch",value:!0},{key:"globalPollingInterval",description:"Global content script polling interval",type:"number",extraText:"ms",value:100},{key:"successiveClickTimeout",description:"Timeout between clicking unique buttons",type:"number",extraText:"ms",value:2500},{key:"notificationSoundURL",description:"Notification sound URL (mp3 hotlink)",type:"text",value:"https://github.com/albert-sun/tamper-scripts/blob/main/resources/notification.mp3?raw=true"},{key:"whitelistedKeywords",description:"Whitelisted keywords (comma-separated)",type:"text",value:"3060,3060ti,3060 ti,3070,3070ti,3070 ti,3080,3080ti,3080 ti,3090"},{key:"blacklistedKeywords",description:"Blacklisted keywords (comma-separated)",type:"text",value:""}]}},1209:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{a(n.next(e))}catch(e){r(e)}}function l(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,l)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveSettingsKV=t.retrieveSettings=t.storageGet=t.elementColor=t.sleep=void 0;const i=o(9416),r=o(8681);t.sleep=function(e){return new Promise((t=>setTimeout(t,e)))};const s=[{color:"yellow",r:255,g:224,b:0},{color:"blue",r:0,g:30,b:115},{color:"grey",r:197,g:203,b:213},{color:"white",r:255,g:255,b:255}];function l(e,t){return n(this,void 0,void 0,(function*(){const o=yield i.browser.storage.local.get(e);return void 0!==o[e]?o[e]:t}))}function a(e){return n(this,void 0,void 0,(function*(){const t=r.defaultSettings[e];for(const o of t){if(void 0===o.value)continue;const t=`setting-${e}-${o.key}`;o.value=yield l(t,o.value)}return t}))}t.elementColor=function(e){const t=getComputedStyle(e,null).getPropertyValue("background-color");if(t.includes("rgb(0, 0, 0"))return"transparent";const o={r:0,g:0,b:0},n=t.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i);o.r=Number(n[1]),o.g=Number(n[2]),o.b=Number(n[3]);const i={color:"",distance:442};for(const e of s){const t=Math.sqrt(Math.pow(o.r-e.r,2)+Math.pow(o.g-e.g,2)+(o.b-e.b));t<i.distance&&(i.color=e.color,i.distance=t)}return i.color},t.storageGet=l,t.retrieveSettings=a,t.retrieveSettingsKV=function(e){return n(this,void 0,void 0,(function*(){const t={},o=yield a(e);for(const e of o)void 0!==e.value&&(t[e.key]=e);return t}))}}},o={};function n(e){var i=o[e];if(void 0!==i)return i.exports;var r=o[e]={exports:{}};return t[e].call(r.exports,r,r.exports,n),r.exports}n.m=t,e=[],n.O=(t,o,i,r)=>{if(!o){var s=1/0;for(c=0;c<e.length;c++){for(var[o,i,r]=e[c],l=!0,a=0;a<o.length;a++)(!1&r||s>=r)&&Object.keys(n.O).every((e=>n.O[e](o[a])))?o.splice(a--,1):(l=!1,r<s&&(s=r));l&&(e.splice(c--,1),t=i())}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[o,i,r]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.j=386,(()=>{var e={386:0,533:0};n.O.j=t=>0===e[t];var t=(t,o)=>{var i,r,[s,l,a]=o,c=0;for(i in l)n.o(l,i)&&(n.m[i]=l[i]);if(a)var u=a(n);for(t&&t(o);c<s.length;c++)r=s[c],n.o(e,r)&&e[r]&&e[r][0](),e[s[c]]=0;return n.O(u)},o=self.webpackChunkextension=self.webpackChunkextension||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var i=n.O(void 0,[736],(()=>n(1209)));i=n.O(i)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leHRlbnNpb24vd2VicGFjay9ydW50aW1lL2NodW5rIGxvYWRlZCIsIndlYnBhY2s6Ly9leHRlbnNpb24vLi9zb3VyY2UvY29uc3RhbnRzLnRzIiwid2VicGFjazovL2V4dGVuc2lvbi8uL3NvdXJjZS91dGlsaXRpZXMudHMiLCJ3ZWJwYWNrOi8vZXh0ZW5zaW9uL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2V4dGVuc2lvbi93ZWJwYWNrL3J1bnRpbWUvY29tcGF0IGdldCBkZWZhdWx0IGV4cG9ydCIsIndlYnBhY2s6Ly9leHRlbnNpb24vd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL2V4dGVuc2lvbi93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovL2V4dGVuc2lvbi93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL2V4dGVuc2lvbi93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL2V4dGVuc2lvbi93ZWJwYWNrL3J1bnRpbWUvcnVudGltZUlkIiwid2VicGFjazovL2V4dGVuc2lvbi93ZWJwYWNrL3J1bnRpbWUvanNvbnAgY2h1bmsgbG9hZGluZyIsIndlYnBhY2s6Ly9leHRlbnNpb24vd2VicGFjay9zdGFydHVwIl0sIm5hbWVzIjpbImRlZmVycmVkIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJkZWZhdWx0U2V0dGluZ3MiLCJjaGFuZ2Vsb2dzIiwia2V5IiwiZGVzY3JpcHRpb24iLCJ0eXBlIiwiZXh0cmFUZXh0IiwiX19hd2FpdGVyIiwidGhpcyIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZnVsZmlsbGVkIiwic3RlcCIsIm5leHQiLCJlIiwicmVqZWN0ZWQiLCJyZXN1bHQiLCJkb25lIiwidGhlbiIsImFwcGx5IiwicmV0cmlldmVTZXR0aW5nc0tWIiwicmV0cmlldmVTZXR0aW5ncyIsInN0b3JhZ2VHZXQiLCJlbGVtZW50Q29sb3IiLCJzbGVlcCIsIndlYmV4dGVuc2lvbl9wb2x5ZmlsbF90c18xIiwiY29uc3RhbnRzXzEiLCJtcyIsInNldFRpbWVvdXQiLCJjb2xvcnMiLCJjb2xvciIsInIiLCJnIiwiYiIsInN0b3JhZ2VLZXkiLCJkZWZhdWx0VmFsdWUiLCJzdG9yYWdlUmVzdWx0IiwiYnJvd3NlciIsInN0b3JhZ2UiLCJsb2NhbCIsImdldCIsInVuZGVmaW5lZCIsInNldHRpbmdzQ2F0ZWdvcnkiLCJjYXRlZ29yeVNldHRpbmdzIiwic2V0dGluZyIsInNldHRpbmdLZXkiLCJlbGVtZW50IiwiY29sb3JUZXh0IiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImdldFByb3BlcnR5VmFsdWUiLCJpbmNsdWRlcyIsInBhcnNlZENvbG9yIiwibWF0Y2hlZENvbG9yIiwibWF0Y2giLCJOdW1iZXIiLCJjbG9zZXN0IiwiZGlzdGFuY2UiLCJjaGVja0NvbG9yIiwiTWF0aCIsInNxcnQiLCJwb3ciLCJjYXRlZ29yeVNldHRpbmdzS1YiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiY2FsbCIsIm0iLCJPIiwiY2h1bmtJZHMiLCJmbiIsInByaW9yaXR5Iiwibm90RnVsZmlsbGVkIiwiSW5maW5pdHkiLCJpIiwibGVuZ3RoIiwiaiIsImtleXMiLCJldmVyeSIsInNwbGljZSIsIm4iLCJnZXR0ZXIiLCJfX2VzTW9kdWxlIiwiZCIsImEiLCJkZWZpbml0aW9uIiwibyIsImVudW1lcmFibGUiLCJnbG9iYWxUaGlzIiwiRnVuY3Rpb24iLCJ3aW5kb3ciLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsImluc3RhbGxlZENodW5rcyIsImNodW5rSWQiLCJ3ZWJwYWNrSnNvbnBDYWxsYmFjayIsInBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uIiwiZGF0YSIsIm1vcmVNb2R1bGVzIiwicnVudGltZSIsImNodW5rTG9hZGluZ0dsb2JhbCIsInNlbGYiLCJmb3JFYWNoIiwiYmluZCIsInB1c2giLCJfX3dlYnBhY2tfZXhwb3J0c19fIl0sIm1hcHBpbmdzIjoidUJBQUlBLEUsZ0JDQ0pDLE9BQU9DLGVBQWVDLEVBQVMsYUFBYyxDQUFFQyxPQUFPLElBQ3RERCxFQUFRRSxnQkFBa0JGLEVBQVFHLGdCQUFhLEVBRS9DSCxFQUFRRyxXQUFhLENBQ2pCLENBQ0ksUUFBVyxTQUNYLGFBQWdCLENBQ1osa0VBQ0EsZ0VBQ0EsOERBQ0EsNkVBQ0Esb0VBRUwsQ0FDQyxRQUFXLFNBQ1gsYUFBZ0IsQ0FDWiwwRUFDQSx1RUFFTCxDQUNDLFFBQVcsU0FDWCxhQUFnQixDQUNaLDhIQUNBLGlKQUNBLHFJQUtaSCxFQUFRRSxnQkFBa0IsQ0FDdEIsUUFBVyxDQUNQLENBQUVFLElBQUssb0JBQXFCQyxZQUFhLDZDQUE4Q0MsS0FBTSxjQUFlTCxPQUFPLEdBQ25ILENBQUVHLElBQUssdUJBQXdCQyxZQUFhLDhDQUErQ0MsS0FBTSxjQUFlTCxPQUFPLEdBQ3ZILENBQUVHLElBQUssd0JBQXlCQyxZQUFhLDZDQUE4Q0MsS0FBTSxjQUFlTCxPQUFPLEdBQ3ZILENBQUVHLElBQUssd0JBQXlCQyxZQUFhLHlDQUEwQ0MsS0FBTSxTQUFVQyxVQUFXLEtBQU1OLE1BQU8sS0FDL0gsQ0FBRUcsSUFBSyx5QkFBMEJDLFlBQWEsMENBQTJDQyxLQUFNLFNBQVVDLFVBQVcsS0FBTU4sTUFBTyxNQUNqSSxDQUFFRyxJQUFLLHVCQUF3QkMsWUFBYSx1Q0FBd0NDLEtBQU0sT0FBUUwsTUFBTyw4RkFDekcsQ0FBRUcsSUFBSyxzQkFBdUJDLFlBQWEseUNBQTBDQyxLQUFNLE9BQVFMLE1BQU8sb0VBQzFHLENBQUVH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bl9fd2VicGFja19yZXF1aXJlX18uTyA9IChyZXN1bHQsIGNodW5rSWRzLCBmbiwgcHJpb3JpdHkpID0+IHtcblx0aWYoY2h1bmtJZHMpIHtcblx0XHRwcmlvcml0eSA9IHByaW9yaXR5IHx8IDA7XG5cdFx0Zm9yKHZhciBpID0gZGVmZXJyZWQubGVuZ3RoOyBpID4gMCAmJiBkZWZlcnJlZFtpIC0gMV1bMl0gPiBwcmlvcml0eTsgaS0tKSBkZWZlcnJlZFtpXSA9IGRlZmVycmVkW2kgLSAxXTtcblx0XHRkZWZlcnJlZFtpXSA9IFtjaHVua0lkcywgZm4sIHByaW9yaXR5XTtcblx0XHRyZXR1cm47XG5cdH1cblx0dmFyIG5vdEZ1bGZpbGxlZCA9IEluZmluaXR5O1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IGRlZmVycmVkLmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIFtjaHVua0lkcywgZm4sIHByaW9yaXR5XSA9IGRlZmVycmVkW2ldO1xuXHRcdHZhciBmdWxmaWxsZWQgPSB0cnVlO1xuXHRcdGZvciAodmFyIGogPSAwOyBqIDwgY2h1bmtJZHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdGlmICgocHJpb3JpdHkgJiAxID09PSAwIHx8IG5vdEZ1bGZpbGxlZCA+PSBwcmlvcml0eSkgJiYgT2JqZWN0LmtleXMoX193ZWJwYWNrX3JlcXVpcmVfXy5PKS5ldmVyeSgoa2V5KSA9PiAoX193ZWJwYWNrX3JlcXVpcmVfXy5PW2tleV0oY2h1bmtJZHNbal0pKSkpIHtcblx0XHRcdFx0Y2h1bmtJZHMuc3BsaWNlKGotLSwgMSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmdWxmaWxsZWQgPSBmYWxzZTtcblx0XHRcdFx0aWYocHJpb3JpdHkgPCBub3RGdWxmaWxsZWQpIG5vdEZ1bGZpbGxlZCA9IHByaW9yaXR5O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZihmdWxmaWxsZWQpIHtcblx0XHRcdGRlZmVycmVkLnNwbGljZShpLS0sIDEpXG5cdFx0XHRyZXN1bHQgPSBmbigpO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gcmVzdWx0O1xufTsiLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLmRlZmF1bHRTZXR0aW5ncyA9IGV4cG9ydHMuY2hhbmdlbG9ncyA9IHZvaWQgMDtcclxuLy8gQ2hhbmdlbG9nIGZyb20gcHJldmlvdXMgdmVyc2lvbnNcclxuZXhwb3J0cy5jaGFuZ2Vsb2dzID0gW1xyXG4gICAge1xyXG4gICAgICAgIFwidmVyc2lvblwiOiBcImIwLjIuMFwiLFxyXG4gICAgICAgIFwiYnVsbGV0cG9pbnRzXCI6IFtcclxuICAgICAgICAgICAgYEFkZGVkIEFib3V0IHRhYiBzaG93aW5nIHNvbWUgaW5mb3JtYXRpb24gYW5kIHVzYWdlIGluc3RydWN0aW9uc2AsXHJcbiAgICAgICAgICAgIGBDaGFuZ2VkIGV4dGVuc2lvbiBpY29uIHRvIHNvbWV0aGluZyBzb21ld2hhdCBtb3JlIHByZXNlbnRhYmxlYCxcclxuICAgICAgICAgICAgYFJlbW92ZWQgcGxhY2Vob2xkZXIgbG9nZ2luZyB0YWIgcGVuZGluZyBmdXJ0aGVyIGRldmVsb3BtZW50YCxcclxuICAgICAgICAgICAgYEFkZGVkIGJsYWNrbGlzdGVkIGtleXdvcmRzIGZ1bmN0aW9uYWxpdHkgdG8gc2NyaXB0IChzdGlsbCBubyB0ZXN0IGJ1dHRvbnMpYCxcclxuICAgICAgICAgICAgYE90aGVyIG1pbm9yIGVkaXRzIHRvIGV4dGVuc2lvbiBwb3B1cCBzdHlsaW5nLCBub3RoaW5nIHRvbyBtYWpvcmAsXHJcbiAgICAgICAgXVxyXG4gICAgfSwge1xyXG4gICAgICAgIFwidmVyc2lvblwiOiBcImIwLjEuMFwiLFxyXG4gICAgICAgIFwiYnVsbGV0cG9pbnRzXCI6IFtcclxuICAgICAgICAgICAgYEFkZGVkIGNoYW5nZWxvZyAodGhpcyB0YWIgaGVyZSkgYW5kIHBsYWNlaG9sZGVyIGxvZ2dpbmcgdGFiIGZvciB0ZXN0aW5nYCxcclxuICAgICAgICAgICAgYENoYW5nZWQgZXh0ZW5zaW9uIHNjcmlwdCBsb2FkaW5nIHRvIHdvcmsgc29tZXdoYXQgbW9yZSBkeW5hbWljYWxseWAsXHJcbiAgICAgICAgXVxyXG4gICAgfSwge1xyXG4gICAgICAgIFwidmVyc2lvblwiOiBcImIwLjAuMVwiLFxyXG4gICAgICAgIFwiYnVsbGV0cG9pbnRzXCI6IFtcclxuICAgICAgICAgICAgYFBvcnRlZCBtb3N0IGZ1bmN0aW9uYWxpdHkgZnJvbSBUYW1wZXJtb25rZXkgc2NyaXB0IGxvY2F0ZWQgPGEgaHJlZj1cImh0dHBzOi8vZ2l0aHViLmNvbS9hbGJlcnQtc3VuL3RhbXBlci1zY3JpcHRzL1wiPmhlcmU8L2E+YCxcclxuICAgICAgICAgICAgYDxiPkZlYXR1cmVzIG5vdCB5ZXQgaW1wbGVtZW50ZWQ8L2I+OiBibGFja2xpc3RlZCBrZXl3b3JkcyBhbmQgYnV0dG9ucyBmb3IgdGVzdGluZyB3dGloaW4gc2V0dGluZ3MgKHJlbW92ZWQgdW50aWwgc2V0dGluZ3Mgc3RydWN0dXJlIGZpbmFsaXplZClgLFxyXG4gICAgICAgICAgICBgPGI+SW1wcm92ZW1lbnRzIGZyb20gVGFtcGVybW9ua2V5IHNjcmlwdDwvYj46IEluc3RhbnQgc2V0dGluZ3MgcHJvcG9nYXRpb24gYW5kIG5vIHJlZnJlc2ggcmVxdWlyZWQgZm9yIGNhcnQgYWRkaXRpb24gb3IgcmVtb3ZhbGBcclxuICAgICAgICBdXHJcbiAgICB9XHJcbl07XHJcbi8vIFNldHRpbmdzIGFjcm9zcyBhbGwgY2F0ZWdvcmllcyBmb3IgZXh0ZW5zaW9uXHJcbmV4cG9ydHMuZGVmYXVsdFNldHRpbmdzID0ge1xyXG4gICAgXCJiZXN0YnV5XCI6IFtcclxuICAgICAgICB7IGtleTogXCJhdXRvbWF0aWNRdWV1ZUZpeFwiLCBkZXNjcmlwdGlvbjogXCJBdHRlbXB0IHRvIGF1dG9tYXRpY2FsbHkgZml4IGJyb2tlbiBxdWV1ZXNcIiwgdHlwZTogXCJzbGlkZVN3aXRjaFwiLCB2YWx1ZTogdHJ1ZSB9LFxyXG4gICAgICAgIHsga2V5OiBcImF1dG9DbGlja1doaXRlbGlzdGVkXCIsIGRlc2NyaXB0aW9uOiBcIkF1dG9tYXRpY2FsbHkgY2xpY2sgd2hpdGVsaXN0ZWQgQVRDIGJ1dHRvbnNcIiwgdHlwZTogXCJzbGlkZVN3aXRjaFwiLCB2YWx1ZTogdHJ1ZSB9LFxyXG4gICAgICAgIHsga2V5OiBcInN0b3BDbGlja0NhcnRPY2N1cGllZFwiLCBkZXNjcmlwdGlvbjogXCJTdG9wIGF1dG9tYXRpYyBjbGlja2luZyB3aGVuIGNhcnQgb2NjdXBpZWRcIiwgdHlwZTogXCJzbGlkZVN3aXRjaFwiLCB2YWx1ZTogdHJ1ZSB9LFxyXG4gICAgICAgIHsga2V5OiBcImdsb2JhbFBvbGxpbmdJbnRlcnZhbFwiLCBkZXNjcmlwdGlvbjogXCJHbG9iYWwgY29udGVudCBzY3JpcHQgcG9sbGluZyBpbnRlcnZhbFwiLCB0eXBlOiBcIm51bWJlclwiLCBleHRyYVRleHQ6IFwibXNcIiwgdmFsdWU6IDEwMCB9LFxyXG4gICAgICAgIHsga2V5OiBcInN1Y2Nlc3NpdmVDbGlja1RpbWVvdXRcIiwgZGVzY3JpcHRpb246IFwiVGltZW91dCBiZXR3ZWVuIGNsaWNraW5nIHVuaXF1ZSBidXR0b25zXCIsIHR5cGU6IFwibnVtYmVyXCIsIGV4dHJhVGV4dDogXCJtc1wiLCB2YWx1ZTogMjUwMCB9LFxyXG4gICAgICAgIHsga2V5OiBcIm5vdGlmaWNhdGlvblNvdW5kVVJMXCIsIGRlc2NyaXB0aW9uOiBcIk5vdGlmaWNhdGlvbiBzb3VuZCBVUkwgKG1wMyBob3RsaW5rKVwiLCB0eXBlOiBcInRleHRcIiwgdmFsdWU6IFwiaHR0cHM6Ly9naXRodWIuY29tL2FsYmVydC1zdW4vdGFtcGVyLXNjcmlwdHMvYmxvYi9tYWluL3Jlc291cmNlcy9ub3RpZmljYXRpb24ubXAzP3Jhdz10cnVlXCIgfSxcclxuICAgICAgICB7IGtleTogXCJ3aGl0ZWxpc3RlZEtleXdvcmRzXCIsIGRlc2NyaXB0aW9uOiBcIldoaXRlbGlzdGVkIGtleXdvcmRzIChjb21tYS1zZXBhcmF0ZWQpXCIsIHR5cGU6IFwidGV4dFwiLCB2YWx1ZTogXCIzMDYwLDMwNjB0aSwzMDYwIHRpLDMwNzAsMzA3MHRpLDMwNzAgdGksMzA4MCwzMDgwdGksMzA4MCB0aSwzMDkwXCIgfSxcclxuICAgICAgICB7IGtleTogXCJibGFja2xpc3RlZEtleXdvcmRzXCIsIGRlc2NyaXB0aW9uOiBcIkJsYWNrbGlzdGVkIGtleXdvcmRzIChjb21tYS1zZXBhcmF0ZWQpXCIsIHR5cGU6IFwidGV4dFwiLCB2YWx1ZTogXCJcIiB9LFxyXG4gICAgICAgIC8vIHsga2V5OiBcInRlc3ROb3RpZmljYXRpb25Tb3VuZFwiLCBkZXNjcmlwdGlvbjogXCJQbGF5IGN1cnJlbnQgbm90aWZpY2F0aW9uIHNvdW5kXCIsIHR5cGU6IFwiYnV0dG9uXCIsIGluc3RydWN0aW9uOiBcInRlc3ROb3RpZmljYXRpb25Tb3VuZFwiIH0sXHJcbiAgICBdXHJcbn07XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5yZXRyaWV2ZVNldHRpbmdzS1YgPSBleHBvcnRzLnJldHJpZXZlU2V0dGluZ3MgPSBleHBvcnRzLnN0b3JhZ2VHZXQgPSBleHBvcnRzLmVsZW1lbnRDb2xvciA9IGV4cG9ydHMuc2xlZXAgPSB2b2lkIDA7XHJcbmNvbnN0IHdlYmV4dGVuc2lvbl9wb2x5ZmlsbF90c18xID0gcmVxdWlyZShcIndlYmV4dGVuc2lvbi1wb2x5ZmlsbC10c1wiKTtcclxuY29uc3QgY29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi9jb25zdGFudHNcIik7XHJcbi8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzk1MTAyMS93aGF0LWlzLXRoZS1qYXZhc2NyaXB0LXZlcnNpb24tb2Ytc2xlZXBcclxuLy8gUG9zc2libHkgaGFzIGlzc3VlcyByZXNvbHZpbmcgb24gRmlyZWZveD8gU3RhY2tPdmVyZmxvdyBzdXJlIGRvZXNuJ3QgdGhpbmsgc28uLi5cclxuZnVuY3Rpb24gc2xlZXAobXMpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpKTtcclxufVxyXG5leHBvcnRzLnNsZWVwID0gc2xlZXA7XHJcbi8vIEFwcHJveGltYXRlcyB0aGUgcmVuZGVyZWQgYmFja2dyb3VuZCBjb2xvciBvZiBhIGdpdmVuIGVsZW1lbnQgdG8gYSBnaXZlbiBzZXQgb2YgY29sb3JzLlxyXG4vLyBDaGVja3Mgd2hldGhlciB0aGUgXCJkaXN0YW5jZVwiIGZyb20gdGhlIGVsZW1lbnQgY29sb3IgaXMgdHJhbnNwYXJlbnQgb3IgY2xvc2VzdCB0byBlaXRoZXIgeWVsbG93L3doaXRlL2JsdWUuXHJcbmNvbnN0IGNvbG9ycyA9IFtcclxuICAgIHsgY29sb3I6IFwieWVsbG93XCIsIHI6IDI1NSwgZzogMjI0LCBiOiAwIH0sXHJcbiAgICB7IGNvbG9yOiBcImJsdWVcIiwgcjogMCwgZzogMzAsIGI6IDExNSB9LFxyXG4gICAgeyBjb2xvcjogXCJncmV5XCIsIHI6IDE5NywgZzogMjAzLCBiOiAyMTMgfSxcclxuICAgIHsgY29sb3I6IFwid2hpdGVcIiwgcjogMjU1LCBnOiAyNTUsIGI6IDI1NSB9LFxyXG5dO1xyXG5mdW5jdGlvbiBlbGVtZW50Q29sb3IoZWxlbWVudCkge1xyXG4gICAgLy8gR2V0IHRoZSByZW5kZXJlZCBiYWNrZ3JvdW5kIGNvbG9yIG9mIHRoZSBlbGVtZW50XHJcbiAgICBjb25zdCBjb2xvclRleHQgPSBnZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQsIG51bGwpLmdldFByb3BlcnR5VmFsdWUoXCJiYWNrZ3JvdW5kLWNvbG9yXCIpO1xyXG4gICAgaWYgKGNvbG9yVGV4dC5pbmNsdWRlcyhcInJnYigwLCAwLCAwXCIpKSB7IC8vIGVsZW1lbnQgaGFzIG5vIGNvbG9yID0gdHJhbnNwYXJlbnRcclxuICAgICAgICByZXR1cm4gXCJ0cmFuc3BhcmVudFwiO1xyXG4gICAgfVxyXG4gICAgLy8gUGFyc2UgUkdCIHZhbHVlIGFuZCB1c2UgZmFuY3kgbWF0aHMgdG8gZmluZCBjbG9zZXN0IGNvbG9yXHJcbiAgICBjb25zdCBwYXJzZWRDb2xvciA9IHsgcjogMCwgZzogMCwgYjogMCB9O1xyXG4gICAgY29uc3QgbWF0Y2hlZENvbG9yID0gY29sb3JUZXh0Lm1hdGNoKC9ecmdiXFxzKlxcKFxccyooXFxkKylcXHMqLFxccyooXFxkKylcXHMqLFxccyooXFxkKylcXHMqXFwpJC9pKTtcclxuICAgIHBhcnNlZENvbG9yLnIgPSBOdW1iZXIobWF0Y2hlZENvbG9yWzFdKTtcclxuICAgIHBhcnNlZENvbG9yLmcgPSBOdW1iZXIobWF0Y2hlZENvbG9yWzJdKTtcclxuICAgIHBhcnNlZENvbG9yLmIgPSBOdW1iZXIobWF0Y2hlZENvbG9yWzNdKTtcclxuICAgIGNvbnN0IGNsb3Nlc3QgPSB7IGNvbG9yOiBcIlwiLCBkaXN0YW5jZTogNDQyIH07IC8vIERlZmF1bHQgZGlzdGFuY2UganVzdCBzbGlnaHRseSBsYXJnZXIgdGhhbiBtYXhcclxuICAgIGZvciAoY29uc3QgY2hlY2tDb2xvciBvZiBjb2xvcnMpIHtcclxuICAgICAgICBjb25zdCBkaXN0YW5jZSA9IE1hdGguc3FydChNYXRoLnBvdygocGFyc2VkQ29sb3IuciAtIGNoZWNrQ29sb3IuciksIDIpICsgTWF0aC5wb3coKHBhcnNlZENvbG9yLmcgLSBjaGVja0NvbG9yLmcpLCAyKSArIChwYXJzZWRDb2xvci5iIC0gY2hlY2tDb2xvci5iKSk7XHJcbiAgICAgICAgaWYgKGRpc3RhbmNlIDwgY2xvc2VzdC5kaXN0YW5jZSkge1xyXG4gICAgICAgICAgICBjbG9zZXN0LmNvbG9yID0gY2hlY2tDb2xvci5jb2xvcjtcclxuICAgICAgICAgICAgY2xvc2VzdC5kaXN0YW5jZSA9IGRpc3RhbmNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBjbG9zZXN0LmNvbG9yO1xyXG59XHJcbmV4cG9ydHMuZWxlbWVudENvbG9yID0gZWxlbWVudENvbG9yO1xyXG4vLyBXcmFwcGVyIGZvciByZXRyaWV2aW5nIGZyb20gc3RvcmFnZSB3aXRoIGRlZmF1bHQgdmFsdWUgaWYgdW5kZWZpbmVkXHJcbmZ1bmN0aW9uIHN0b3JhZ2VHZXQoc3RvcmFnZUtleSwgZGVmYXVsdFZhbHVlKSB7XHJcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IHN0b3JhZ2VSZXN1bHQgPSB5aWVsZCB3ZWJleHRlbnNpb25fcG9seWZpbGxfdHNfMS5icm93c2VyLnN0b3JhZ2UubG9jYWwuZ2V0KHN0b3JhZ2VLZXkpO1xyXG4gICAgICAgIHJldHVybiBzdG9yYWdlUmVzdWx0W3N0b3JhZ2VLZXldICE9PSB1bmRlZmluZWRcclxuICAgICAgICAgICAgPyBzdG9yYWdlUmVzdWx0W3N0b3JhZ2VLZXldIDogZGVmYXVsdFZhbHVlO1xyXG4gICAgfSk7XHJcbn1cclxuZXhwb3J0cy5zdG9yYWdlR2V0ID0gc3RvcmFnZUdldDtcclxuLy8gV3JhcHBlciBmb3IgcmV0cmlldmluZyBzZXR0aW5ncyBmb3IgZ2l2ZW4gY2F0ZWdvcnkgYnkgdXBkYXRpbmcgZnJvbSBTdG9yYWdlIEFQSVxyXG5mdW5jdGlvbiByZXRyaWV2ZVNldHRpbmdzKHNldHRpbmdzQ2F0ZWdvcnkpIHtcclxuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgLy8gR2V0IGRlZmF1bHQgc2V0dGluZ3MsIHRoZW4gdXBkYXRlIGluZGl2aWR1YWwgc2V0dGluZ3MgZnJvbSBTdG9yYWdlIEFQSVxyXG4gICAgICAgIGNvbnN0IGNhdGVnb3J5U2V0dGluZ3MgPSBjb25zdGFudHNfMS5kZWZhdWx0U2V0dGluZ3Nbc2V0dGluZ3NDYXRlZ29yeV07XHJcbiAgICAgICAgZm9yIChjb25zdCBzZXR0aW5nIG9mIGNhdGVnb3J5U2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgLy8gSWdub3JlIHNldHRpbmdzIHdpdGhvdXQgYSB2YWx1ZSAoYnV0dG9ucyBtYWlubHkpXHJcbiAgICAgICAgICAgIGlmIChzZXR0aW5nLnZhbHVlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIFJlcGxhY2Ugd2l0aCB2YWx1ZSBmcm9tIHN0b3JhZ2UgaWYgbW9kaWZpZWQgZXhpc3RzLCBvdGhlcndpc2Uga2VlcCBkZWZhdWx0XHJcbiAgICAgICAgICAgIGNvbnN0IHNldHRpbmdLZXkgPSBgc2V0dGluZy0ke3NldHRpbmdzQ2F0ZWdvcnl9LSR7c2V0dGluZy5rZXl9YDtcclxuICAgICAgICAgICAgc2V0dGluZy52YWx1ZSA9IHlpZWxkIHN0b3JhZ2VHZXQoc2V0dGluZ0tleSwgc2V0dGluZy52YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjYXRlZ29yeVNldHRpbmdzO1xyXG4gICAgfSk7XHJcbn1cclxuZXhwb3J0cy5yZXRyaWV2ZVNldHRpbmdzID0gcmV0cmlldmVTZXR0aW5ncztcclxuLy8gV3JhcHBlciBmb3IgZm9ybWF0dGluZyB0aGUgc2V0dGluZ3MgaW50byBrZXktdmFsdWUgaW5zdGVhZCBvZiBhcnJheVxyXG5mdW5jdGlvbiByZXRyaWV2ZVNldHRpbmdzS1Yoc2V0dGluZ3NDYXRlZ29yeSkge1xyXG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCBjYXRlZ29yeVNldHRpbmdzS1YgPSB7fTtcclxuICAgICAgICBjb25zdCBjYXRlZ29yeVNldHRpbmdzID0geWllbGQgcmV0cmlldmVTZXR0aW5ncyhzZXR0aW5nc0NhdGVnb3J5KTsgLy8gR2V0IHNldHRpbmdzIGJlZm9yZSByZWZvcm1hdHRpbmdcclxuICAgICAgICBmb3IgKGNvbnN0IHNldHRpbmcgb2YgY2F0ZWdvcnlTZXR0aW5ncykge1xyXG4gICAgICAgICAgICAvLyBJZ25vcmUgc2V0dGluZ3Mgd2l0aG91dCBhIHZhbHVlIChidXR0b25zIG1haW5seSlcclxuICAgICAgICAgICAgaWYgKHNldHRpbmcudmFsdWUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0ZWdvcnlTZXR0aW5nc0tWW3NldHRpbmcua2V5XSA9IHNldHRpbmc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjYXRlZ29yeVNldHRpbmdzS1Y7XHJcbiAgICB9KTtcclxufVxyXG5leHBvcnRzLnJldHJpZXZlU2V0dGluZ3NLViA9IHJldHJpZXZlU2V0dGluZ3NLVjtcclxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbi8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBfX3dlYnBhY2tfbW9kdWxlc19fO1xuXG4iLCIvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gKG1vZHVsZSkgPT4ge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHQoKSA9PiAobW9kdWxlWydkZWZhdWx0J10pIDpcblx0XHQoKSA9PiAobW9kdWxlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uaiA9IDM4NjsiLCIvLyBubyBiYXNlVVJJXG5cbi8vIG9iamVjdCB0byBzdG9yZSBsb2FkZWQgYW5kIGxvYWRpbmcgY2h1bmtzXG4vLyB1bmRlZmluZWQgPSBjaHVuayBub3QgbG9hZGVkLCBudWxsID0gY2h1bmsgcHJlbG9hZGVkL3ByZWZldGNoZWRcbi8vIFtyZXNvbHZlLCByZWplY3QsIFByb21pc2VdID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxudmFyIGluc3RhbGxlZENodW5rcyA9IHtcblx0Mzg2OiAwLFxuXHQ1MzM6IDBcbn07XG5cbi8vIG5vIGNodW5rIG9uIGRlbWFuZCBsb2FkaW5nXG5cbi8vIG5vIHByZWZldGNoaW5nXG5cbi8vIG5vIHByZWxvYWRlZFxuXG4vLyBubyBITVJcblxuLy8gbm8gSE1SIG1hbmlmZXN0XG5cbl9fd2VicGFja19yZXF1aXJlX18uTy5qID0gKGNodW5rSWQpID0+IChpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPT09IDApO1xuXG4vLyBpbnN0YWxsIGEgSlNPTlAgY2FsbGJhY2sgZm9yIGNodW5rIGxvYWRpbmdcbnZhciB3ZWJwYWNrSnNvbnBDYWxsYmFjayA9IChwYXJlbnRDaHVua0xvYWRpbmdGdW5jdGlvbiwgZGF0YSkgPT4ge1xuXHR2YXIgW2NodW5rSWRzLCBtb3JlTW9kdWxlcywgcnVudGltZV0gPSBkYXRhO1xuXHQvLyBhZGQgXCJtb3JlTW9kdWxlc1wiIHRvIHRoZSBtb2R1bGVzIG9iamVjdCxcblx0Ly8gdGhlbiBmbGFnIGFsbCBcImNodW5rSWRzXCIgYXMgbG9hZGVkIGFuZCBmaXJlIGNhbGxiYWNrXG5cdHZhciBtb2R1bGVJZCwgY2h1bmtJZCwgaSA9IDA7XG5cdGZvcihtb2R1bGVJZCBpbiBtb3JlTW9kdWxlcykge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhtb3JlTW9kdWxlcywgbW9kdWxlSWQpKSB7XG5cdFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLm1bbW9kdWxlSWRdID0gbW9yZU1vZHVsZXNbbW9kdWxlSWRdO1xuXHRcdH1cblx0fVxuXHRpZihydW50aW1lKSB2YXIgcmVzdWx0ID0gcnVudGltZShfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblx0aWYocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24pIHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uKGRhdGEpO1xuXHRmb3IoO2kgPCBjaHVua0lkcy5sZW5ndGg7IGkrKykge1xuXHRcdGNodW5rSWQgPSBjaHVua0lkc1tpXTtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSAmJiBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0pIHtcblx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXVswXSgpO1xuXHRcdH1cblx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZHNbaV1dID0gMDtcblx0fVxuXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXy5PKHJlc3VsdCk7XG59XG5cbnZhciBjaHVua0xvYWRpbmdHbG9iYWwgPSBzZWxmW1wid2VicGFja0NodW5rZXh0ZW5zaW9uXCJdID0gc2VsZltcIndlYnBhY2tDaHVua2V4dGVuc2lvblwiXSB8fCBbXTtcbmNodW5rTG9hZGluZ0dsb2JhbC5mb3JFYWNoKHdlYnBhY2tKc29ucENhbGxiYWNrLmJpbmQobnVsbCwgMCkpO1xuY2h1bmtMb2FkaW5nR2xvYmFsLnB1c2ggPSB3ZWJwYWNrSnNvbnBDYWxsYmFjay5iaW5kKG51bGwsIGNodW5rTG9hZGluZ0dsb2JhbC5wdXNoLmJpbmQoY2h1bmtMb2FkaW5nR2xvYmFsKSk7IiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBkZXBlbmRzIG9uIG90aGVyIGxvYWRlZCBjaHVua3MgYW5kIGV4ZWN1dGlvbiBuZWVkIHRvIGJlIGRlbGF5ZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXy5PKHVuZGVmaW5lZCwgWzczNl0sICgpID0+IChfX3dlYnBhY2tfcmVxdWlyZV9fKDEyMDkpKSlcbl9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fLk8oX193ZWJwYWNrX2V4cG9ydHNfXyk7XG4iXSwic291cmNlUm9vdCI6IiJ9